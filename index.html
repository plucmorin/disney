<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de courriels Disney - Voyages en Route</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 8px rgba(52, 152, 219, 0.2);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease; /* Added box-shadow transition */
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }

        .output-section {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 25px;
            max-height: 800px; /* Consider a bit more height if content is long */
            overflow-y: auto;
        }

        .email-preview {
            font-family: 'Aptos', 'Calibri', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Added more fallbacks */
            line-height: 1.6;
            white-space: pre-wrap; /* This is key for preserving newlines from the string */
            color: #333; /* Default text color for preview */
            font-size: 15px; /* Slightly larger base font for readability */
        }

        .email-title { /* This class is now applied via JS for preview */
            color: #0066cc; /* Disney-esque blue */
            font-weight: bold;
            text-transform: uppercase;
            margin-top: 20px; /* Increased margin for better separation */
            margin-bottom: 10px;
            font-size: 1.2em; /* Slightly larger title */
            /* border-bottom: 1px solid #eee; /* Optional: adds a light line under title */
            /* padding-bottom: 5px; /* Optional: padding for the line */
        }


        .copy-btn {
            margin-top: 15px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .copy-btn:hover {
            background: linear-gradient(135deg, #2ecc71, #27ae60); /* Keep consistent hover */
            transform: translateY(-2px); /* Added hover effect consistent with other buttons */
            box-shadow: 0 8px 20px rgba(39, 174, 96, 0.3); /* Added hover shadow */
        }

        .hotel-option {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: white;
        }

        .hotel-option h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .add-hotel-btn {
            background: linear-gradient(135deg, #e67e22, #d35400); /* Changed color to orange */
            padding: 10px 20px;
            margin-bottom: 15px;
        }
         .add-hotel-btn:hover {
            background: linear-gradient(135deg, #d35400, #e67e22);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(230, 126, 34, 0.3);
        }


        .remove-hotel-btn { /* New class for styling remove button */
            background: linear-gradient(135deg, #e74c3c, #c0392b) !important; /* Important to override inline style if any */
            color: white !important;
            border: none !important;
            padding: 8px 15px !important;
            border-radius: 5px !important;
            cursor: pointer !important;
            transition: transform 0.2s ease, box-shadow 0.2s ease !important;
        }
        .remove-hotel-btn:hover {
             transform: translateY(-2px) !important;
             box-shadow: 0 6px 15px rgba(231, 76, 60, 0.3) !important;
        }


        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè∞ G√©n√©rateur de courriels Disney</h1>
            <p>Voyages en Route - Sp√©cialiste Disney & Universal</p>
        </div>
        
        <div class="content">
            <div class="form-section">
                <h2>Informations du voyage</h2>
                
                <div class="form-group">
                    <label for="langue">Langue du courriel :</label>
                    <select id="langue">
                        <option value="fr">Fran√ßais</option>
                        <option value="en">English</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="nomClient">Nom du client :</label>
                    <input type="text" id="nomClient" placeholder="Nom complet du client">
                </div>

                <div class="form-group">
                    <label for="nbAdultes">Nombre d'adultes :</label>
                    <input type="number" id="nbAdultes" min="1" value="2">
                </div>

                <div class="form-group">
                    <label for="nbEnfants">Nombre d'enfants :</label>
                    <input type="number" id="nbEnfants" min="0" value="0">
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="billetSeulement">
                    <label for="billetSeulement">Billets seulement (pas d'h√¥tel)</label>
                </div>

                <div id="hotelSection">
                    <button type="button" class="btn add-hotel-btn" onclick="ajouterHotel()">+ Ajouter un h√¥tel</button>
                    <div id="hotelOptions"></div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="avionInclus">
                    <label for="avionInclus">Avion inclus</label>
                </div>

                <div id="avionSection" style="display: none;">
                    <div class="form-group">
                        <label for="dateAller">Date et heure de d√©part :</label>
                        <input type="datetime-local" id="dateAller">
                    </div>
                    <div class="form-group">
                        <label for="aeroportDepart">A√©roport de d√©part :</label>
                        <input type="text" id="aeroportDepart" placeholder="Ex: YUL - Montr√©al">
                    </div>
                    <div class="form-group">
                        <label for="dateRetour">Date et heure de retour :</label>
                        <input type="datetime-local" id="dateRetour">
                    </div>
                    <div class="form-group">
                        <label for="aeroportRetour">A√©roport de retour :</label>
                        <input type="text" id="aeroportRetour" placeholder="Ex: MCO - Orlando">
                    </div>
                    <div class="form-group">
                        <label for="prixAvion">Prix total avion (CAD) :</label> {/* Changed to CAD */}
                        <input type="number" id="prixAvion" placeholder="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="promotion">Promotion applicable :</label>
                    <input type="text" id="promotion" placeholder="Nom de la promotion ou laissez vide si aucune">
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="promotionDateFin">
                    <label for="promotionDateFin">La promotion a une date de fin connue</label>
                </div>

                <button type="button" class="btn" onclick="genererCourriel()">G√©n√©rer le courriel</button>
            </div>

            <div class="output-section">
                <h2>Aper√ßu du courriel</h2>
                <div id="emailPreview" class="email-preview">
                    Le courriel g√©n√©r√© appara√Ætra ici...
                </div>
                <button type="button" class="btn copy-btn" onclick="copierCourriel()">üìã Copier le courriel</button>
            </div>
        </div>
    </div>

    <script>
        const hotelsList = [
            "Bay Lake Tower at Disney's Contemporary Resort", "Boulder Ridge Villas at Disney's Wilderness Lodge", "Copper Creek Villas & Cabins √† Disney's Wilderness Lodge", "Disney's All-Star Movies Resort", "Disney's All-Star Music Resort", "Disney's All-Star Sports Resort", "Disney's Animal Kingdom Lodge", "Disney's Animal Kingdom Villas - Jambo House", "Disney's Animal Kingdom Villas - Kidani Village", "Disney's Art of Animation Resort", "Disney's Beach Club Resort", "Disney's Beach Club Villas", "Disney's BoardWalk Inn", "Disney's BoardWalk Villas", "Disney's Caribbean Beach Resort", "Disney's Contemporary Resort", "Disney's Coronado Springs Resort", "Disney's Grand Floridian Resort & Spa", "Disney's Old Key West Resort", "Disney's Polynesian Village Resort", "Disney's Polynesian Villas & Bungalows", "Disney's Pop Century Resort", "Disney's Port Orleans Resort - French Quarter", "Disney's Port Orleans Resort - Riverside", "Disney's Saratoga Springs Resort & Spa", "Disney's Wilderness Lodge", "Disney's Yacht Club Resort", "Disney's Riviera Resort", "The Cabins at Disney's Fort Wilderness Resort", "The Cabins at Disney's Fort Wilderness Resort ‚Äì A Disney Vacation Club Resort", "Les terrains de camping au Disney's Fort Wilderness Resort", "Les villas au Disney's Grand Floridian Resort & Spa"
        ];

        const hotelDescriptions = {
            "Bay Lake Tower at Disney's Contemporary Resort": { fr: "CAT√âGORIE DELUXE VILLA - Complexe Disney Vacation Club moderne au th√®me contemporain/futuriste. Situ√© adjacent au Contemporary Resort avec acc√®s monorail direct au Magic Kingdom. Villas spacieuses avec cuisinettes, vue sur Magic Kingdom ou Bay Lake. Avantages : Early Theme Park Entry, piscine avec toboggan, restaurants sur place, acc√®s aux installations du Contemporary Resort.", en: "DELUXE VILLA CATEGORY - Modern Disney Vacation Club resort with contemporary/futuristic theme. Located adjacent to Contemporary Resort with direct monorail access to Magic Kingdom. Spacious villas with kitchenettes, Magic Kingdom or Bay Lake views. Benefits: Early Theme Park Entry, pool with slide, on-site restaurants, access to Contemporary Resort amenities." },
            "Boulder Ridge Villas at Disney's Wilderness Lodge": { fr: "CAT√âGORIE DELUXE VILLA - Villas Disney Vacation Club au th√®me des parcs nationaux am√©ricains dans une ambiance de lodge rustique. Architecture inspir√©e du Old Faithful Inn. Villas avec cuisinettes, balcons donnant sur la for√™t ou la cour. Avantages : Early Theme Park Entry, piscines th√©matiques, transport en bateau vers Magic Kingdom, restaurants signature.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas with American national parks theme in rustic lodge atmosphere. Architecture inspired by Old Faithful Inn. Villas with kitchenettes, balconies overlooking forest or courtyard. Benefits: Early Theme Park Entry, themed pools, boat transportation to Magic Kingdom, signature restaurants." },
            "Copper Creek Villas & Cabins √† Disney's Wilderness Lodge": { fr: "CAT√âGORIE DELUXE VILLA - Villas et cabines Disney Vacation Club au th√®me des parcs nationaux dans un cadre de nature sauvage. Nouvelles villas avec cuisinettes compl√®tes, cabines isol√©es en for√™t. Ambiance rustique luxueuse. Avantages : Early Theme Park Entry, piscines avec toboggan, transport en bateau, spa Senses, restaurants gastronomiques.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas and cabins with national parks theme in wilderness setting. New villas with full kitchenettes, secluded forest cabins. Luxurious rustic atmosphere. Benefits: Early Theme Park Entry, pools with slide, boat transportation, Senses Spa, gourmet restaurants." },
            "Disney's All-Star Movies Resort": { fr: "CAT√âGORIE VALUE - H√¥tel th√©matique c√©l√©brant les films Disney classiques avec des ic√¥nes g√©antes (101 Dalmatiens, Toy Story, Fantasia, Love Bug, Mighty Ducks). Chambres standard √©conomiques pour familles. Avantages : Early Theme Park Entry, piscines th√©matiques, aires de jeux, food court, transport en autobus vers tous les parcs.", en: "VALUE CATEGORY - Themed hotel celebrating classic Disney movies with giant icons (101 Dalmatians, Toy Story, Fantasia, Love Bug, Mighty Ducks). Budget-friendly standard rooms for families. Benefits: Early Theme Park Entry, themed pools, playgrounds, food court, bus transportation to all parks." },
            "Disney's All-Star Music Resort": { fr: "CAT√âGORIE VALUE - H√¥tel th√©matique d√©di√© √† la musique avec des sections country, jazz, rock, calypso et Broadway. D√©corations musicales g√©antes color√©es. Chambres standard abordables. Avantages : Early Theme Park Entry, piscines th√©matiques avec musique, aires de jeux, food court, transport en autobus.", en: "VALUE CATEGORY - Music-themed hotel with country, jazz, rock, calypso and Broadway sections. Giant colorful musical decorations. Affordable standard rooms. Benefits: Early Theme Park Entry, themed pools with music, playgrounds, food court, bus transportation." },
            "Disney's All-Star Sports Resort": { fr: "CAT√âGORIE VALUE - H√¥tel sportif avec sections baseball, football am√©ricain, tennis, basketball et surf. D√©corations sportives g√©antes et terrains de jeux. Chambres standard √©conomiques parfaites pour les familles actives. Avantages : Early Theme Park Entry, piscines th√©matiques, terrains de sport, food court, transport en autobus.", en: "VALUE CATEGORY - Sports-themed hotel with baseball, football, tennis, basketball and surfing sections. Giant sports decorations and playing fields. Budget standard rooms perfect for active families. Benefits: Early Theme Park Entry, themed pools, sports courts, food court, bus transportation." },
            "Disney's Animal Kingdom Lodge": { fr: "CAT√âGORIE DELUXE - H√¥tel safari luxueux avec architecture africaine authentique o√π plus de 200 animaux √©voluent dans 4 savanes. Chambres avec vue sur savane ou piscine. Restaurants africains prim√©s. Avantages : Early Theme Park Entry, piscines avec toboggan, programmes √©ducatifs animaliers, restaurants signature, spa Senses.", en: "DELUXE CATEGORY - Luxurious safari hotel with authentic African architecture where over 200 animals roam 4 savannas. Rooms with savanna or pool views. Award-winning African restaurants. Benefits: Early Theme Park Entry, pools with slide, animal educational programs, signature restaurants, Senses Spa." },
            "Disney's Animal Kingdom Villas - Jambo House": { fr: "CAT√âGORIE DELUXE VILLA - Villas Disney Vacation Club dans le b√¢timent principal d'Animal Kingdom Lodge. Architecture africaine avec vue sur les savanes peupl√©es d'animaux. Villas avec cuisinettes, balcons donnant sur la savane. Avantages : Early Theme Park Entry, observation d'animaux 24h/24, piscines th√©matiques, restaurants africains, programmes √©ducatifs.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas in the main Animal Kingdom Lodge building. African architecture with animal-populated savanna views. Villas with kitchenettes, savanna-view balconies. Benefits: Early Theme Park Entry, 24/7 animal viewing, themed pools, African restaurants, educational programs." },
            "Disney's Animal Kingdom Villas - Kidani Village": { fr: "CAT√âGORIE DELUXE VILLA - Villas Disney Vacation Club avec th√®me africain et savanes priv√©es. Architecture inspir√©e de village africain traditionnel. Villas spacieuses avec cuisinettes compl√®tes, terrasses avec vue sur savane. Avantages : Early Theme Park Entry, savanes exclusives, piscines avec aire de jeux aquatique, restaurants, programmes animaliers.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas with African theme and private savannas. Architecture inspired by traditional African village. Spacious villas with full kitchenettes, savanna-view terraces. Benefits: Early Theme Park Entry, exclusive savannas, pools with water play area, restaurants, animal programs." },
            "Disney's Art of Animation Resort": { fr: "CAT√âGORIE VALUE - H√¥tel immersif c√©l√©brant l'animation Disney avec sections La Petite Sir√®ne, Le Roi Lion, Cars et Nemo. Chambres standard et suites familiales. D√©corations spectaculaires grandeur nature. Avantages : Early Theme Park Entry, plus grande piscine Disney World (Big Blue Pool), aires de jeux th√©matiques, food court, transport en autobus.", en: "VALUE CATEGORY - Immersive hotel celebrating Disney animation with Little Mermaid, Lion King, Cars and Finding Nemo sections. Standard rooms and family suites. Spectacular life-size decorations. Benefits: Early Theme Park Entry, Disney World's largest pool (Big Blue Pool), themed playgrounds, food court, bus transportation." },
            "Disney's Beach Club Resort": { fr: "CAT√âGORIE DELUXE - H√¥tel √©l√©gant au th√®me nautique de la Nouvelle-Angleterre des ann√©es 1870. Situ√© pr√®s d'EPCOT avec plage de sable et la spectaculaire Stormalong Bay. Chambres luxueuses avec balcons. Avantages : Early Theme Park Entry, acc√®s √† pied √† EPCOT et Hollywood Studios, Stormalong Bay (3 acres), restaurants signature, spa.", en: "DELUXE CATEGORY - Elegant hotel with 1870s New England nautical theme. Located near EPCOT with sandy beach and spectacular Stormalong Bay. Luxurious rooms with balconies. Benefits: Early Theme Park Entry, walking distance to EPCOT and Hollywood Studios, Stormalong Bay (3 acres), signature restaurants, spa." },
            "Disney's Beach Club Villas": { fr: "CAT√âGORIE DELUXE VILLA - Villas Disney Vacation Club adjacentes au Beach Club Resort avec m√™me th√®me nautique √©l√©gant. Villas avec cuisinettes, proche d'EPCOT. Acc√®s √† Stormalong Bay. Avantages : Early Theme Park Entry, acc√®s √† pied aux parcs EPCOT/Hollywood Studios, Stormalong Bay, restaurants du Beach Club, transport en bateau.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas adjacent to Beach Club Resort with same elegant nautical theme. Villas with kitchenettes, near EPCOT. Access to Stormalong Bay. Benefits: Early Theme Park Entry, walking distance to EPCOT/Hollywood Studios, Stormalong Bay, Beach Club restaurants, boat transportation." },
            "Disney's BoardWalk Inn": { fr: "CAT√âGORIE DELUXE - H√¥tel romantique inspir√© du boardwalk atlantique des ann√©es 1930 avec promenade anim√©e. Architecture victorienne color√©e, divertissements de rue, boutiques. Avantages : Early Theme Park Entry, acc√®s √† pied √† EPCOT et Hollywood Studios, BoardWalk avec restaurants et bars, piscines th√©matiques, spa, transport en bateau.", en: "DELUXE CATEGORY - Romantic hotel inspired by 1930s Atlantic boardwalk with lively promenade. Colorful Victorian architecture, street entertainment, shops. Benefits: Early Theme Park Entry, walking distance to EPCOT and Hollywood Studios, BoardWalk with restaurants and bars, themed pools, spa, boat transportation." },
            "Disney's BoardWalk Villas": { fr: "CAT√âGORIE DELUXE VILLA - Villas Disney Vacation Club sur le BoardWalk avec th√®me ann√©es 1930. Villas avec cuisinettes, balcons donnant sur le BoardWalk ou jardins. Ambiance festive permanente. Avantages : Early Theme Park Entry, acc√®s √† pied aux parcs, divertissements sur le BoardWalk, restaurants et bars, piscines, transport en bateau.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas on the BoardWalk with 1930s theme. Villas with kitchenettes, balconies overlooking BoardWalk or gardens. Permanent festive atmosphere. Benefits: Early Theme Park Entry, walking distance to parks, BoardWalk entertainment, restaurants and bars, pools, boat transportation." },
            "Disney's Caribbean Beach Resort": { fr: "CAT√âGORIE MODERATE - Complexe tropical inspir√© des Cara√Øbes avec 6 villages color√©s autour du lac Barefoot Bay. Th√®me pirate avec secteur Skyliner. Chambres r√©nov√©es avec mobilier tropical. Avantages : Early Theme Park Entry, Skyliner vers EPCOT/Hollywood Studios, plages de sable, piscines avec forteresse pirate, restaurants, bars.", en: "MODERATE CATEGORY - Tropical resort inspired by the Caribbean with 6 colorful villages around Barefoot Bay lake. Pirate theme with Skyliner section. Renovated rooms with tropical furnishings. Benefits: Early Theme Park Entry, Skyliner to EPCOT/Hollywood Studios, sandy beaches, pools with pirate fortress, restaurants, bars." },
            "Disney's Contemporary Resort": { fr: "CAT√âGORIE DELUXE - H√¥tel iconique futuriste en forme de A o√π le monorail traverse le hall principal. Architecture moderne des ann√©es 1970, vue sur Magic Kingdom et Bay Lake. Avantages : Early Theme Park Entry, monorail direct vers Magic Kingdom, restaurants signature dont California Grill, piscines, plage, spa, marina.", en: "DELUXE CATEGORY - Iconic futuristic A-frame hotel where monorail runs through main lobby. Modern 1970s architecture, Magic Kingdom and Bay Lake views. Benefits: Early Theme Park Entry, direct monorail to Magic Kingdom, signature restaurants including California Grill, pools, beach, spa, marina." },
            "Disney's Coronado Springs Resort": { fr: "CAT√âGORIE MODERATE - Complexe au th√®me du Sud-Ouest am√©ricain et Mexique avec lac artificiel de 15 acres. Tour Gran Destino r√©cemment ajout√©e. Chambres r√©nov√©es, centre de congr√®s. Avantages : Early Theme Park Entry, restaurants vari√©s dont rooftop, piscines avec pyramide maya, spa, centre de fitness, transport en autobus.", en: "MODERATE CATEGORY - Resort with American Southwest and Mexican theme featuring 15-acre man-made lake. Recently added Gran Destino Tower. Renovated rooms, convention center. Benefits: Early Theme Park Entry, varied restaurants including rooftop, pools with Mayan pyramid, spa, fitness center, bus transportation." },
            "Disney's Grand Floridian Resort & Spa": { fr: "CAT√âGORIE DELUXE - Le plus luxueux h√¥tel Disney avec th√®me victorien √©l√©gant de la Floride des ann√©es 1880. Architecture blanche majestueuse, orchestre dans le hall. Service de conciergerie disponible. Avantages : Early Theme Park Entry, monorail vers Magic Kingdom, restaurants gastronomiques, spa Senses complet, plage priv√©e, marina, mariage Disney.", en: "DELUXE CATEGORY - Disney's most luxurious hotel with elegant Victorian Florida 1880s theme. Majestic white architecture, lobby orchestra. Concierge service available. Benefits: Early Theme Park Entry, monorail to Magic Kingdom, gourmet restaurants, full Senses Spa, private beach, marina, Disney weddings." },
            "Disney's Old Key West Resort": { fr: "CAT√âGORIE DELUXE VILLA - Premier complexe Disney Vacation Club avec th√®me des Keys de Floride. Villas spacieuses style maisons de vacances avec cuisinettes compl√®tes, terrasses priv√©es. Ambiance d√©contract√©e de village. Avantages : Early Theme Park Entry, villas les plus spacieuses, piscines paisibles, terrain de golf, restaurants, transport en bateau vers Disney Springs.", en: "DELUXE VILLA CATEGORY - First Disney Vacation Club resort with Florida Keys theme. Spacious vacation home-style villas with full kitchenettes, private porches. Relaxed village atmosphere. Benefits: Early Theme Park Entry, most spacious villas, peaceful pools, golf course, restaurants, boat transportation to Disney Springs." },
            "Disney's Polynesian Village Resort": { fr: "CAT√âGORIE DELUXE - Paradis tropical inspir√© des √Æles du Pacifique Sud avec plages de sable volcanique. B√¢timents longhouses polyn√©siens, v√©g√©tation luxuriante. Ambiance Tiki romantique. Avantages : Early Theme Park Entry, monorail vers Magic Kingdom, restaurants polyn√©siens authentiques, plage avec feux de camp, piscines volcaniques, spa, spirit d'Aloha.", en: "DELUXE CATEGORY - Tropical paradise inspired by South Pacific islands with volcanic sand beaches. Polynesian longhouse buildings, lush vegetation. Romantic Tiki atmosphere. Benefits: Early Theme Park Entry, monorail to Magic Kingdom, authentic Polynesian restaurants, beach with campfires, volcanic pools, spa, spirit of Aloha." },
            "Disney's Polynesian Villas & Bungalows": { fr: "CAT√âGORIE DELUXE VILLA - Villas et bungalows Disney Vacation Club avec th√®me polyn√©sien authentique. Bungalows sur pilotis au-dessus du Seven Seas Lagoon, villas dans les arbres. Vues spectaculaires sur Magic Kingdom. Avantages : Early Theme Park Entry, bungalows uniques sur l'eau, monorail, vues sur feux d'artifice, restaurants polyn√©siens, plages priv√©es.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas and bungalows with authentic Polynesian theme. Overwater bungalows above Seven Seas Lagoon, tree-house villas. Spectacular Magic Kingdom views. Benefits: Early Theme Park Entry, unique overwater bungalows, monorail, fireworks views, Polynesian restaurants, private beaches." },
            "Disney's Pop Century Resort": { fr: "CAT√âGORIE VALUE - H√¥tel nostalgique c√©l√©brant la culture pop am√©ricaine des d√©cennies 1950-1990. Ic√¥nes g√©antes color√©es (yo-yo, t√©l√©phones, etc.). Chambres r√©nov√©es avec mobilier moderne. Avantages : Early Theme Park Entry, Skyliner vers EPCOT/Hollywood Studios, piscines th√©matiques par d√©cennie, food court, transport rapide, prix abordable.", en: "VALUE CATEGORY - Nostalgic hotel celebrating American pop culture from 1950s-1990s decades. Giant colorful icons (yo-yo, phones, etc.). Renovated rooms with modern furnishings. Benefits: Early Theme Park Entry, Skyliner to EPCOT/Hollywood Studios, decade-themed pools, food court, rapid transportation, affordable pricing." },
            "Disney's Port Orleans Resort - French Quarter": { fr: "CAT√âGORIE MODERATE - H√¥tel au charme intime du Vieux Carr√© fran√ßais de La Nouvelle-Orl√©ans. Architecture cr√©ole, cours paisibles, ambiance jazz. Plus petit et romantique des resorts mod√©r√©s. Avantages : Early Theme Park Entry, transport en bateau vers Disney Springs, piscines avec toboggan dragon, restaurants cajuns, bars, atmosph√®re authentique.", en: "MODERATE CATEGORY - Hotel with intimate French Quarter New Orleans charm. Creole architecture, peaceful courtyards, jazz atmosphere. Smallest and most romantic of moderate resorts. Benefits: Early Theme Park Entry, boat transportation to Disney Springs, pools with dragon slide, Cajun restaurants, bars, authentic atmosphere." },
            "Disney's Port Orleans Resort - Riverside": { fr: "CAT√âGORIE MODERATE - Grand complexe au th√®me du Sud am√©ricain avec sections plantation et bayou. Architecture antebellum, jardins luxuriants, rivi√®re Sassagoula. Chambres Royal Guest rooms dans Alligator Bayou. Avantages : Early Theme Park Entry, transport en bateau vers Disney Springs, piscines avec aire de jeux, restaurants du Sud, location de v√©los, p√™che.", en: "MODERATE CATEGORY - Large resort with American South theme featuring plantation and bayou sections. Antebellum architecture, lush gardens, Sassagoula River. Royal Guest rooms in Alligator Bayou. Benefits: Early Theme Park Entry, boat transportation to Disney Springs, pools with play area, Southern restaurants, bike rentals, fishing." },
            "Disney's Saratoga Springs Resort & Spa": { fr: "CAT√âGORIE DELUXE VILLA - Villas Disney Vacation Club inspir√©es des sources thermales victorieuses de Saratoga Springs, NY. Architecture victorienne √©l√©gante, terrains de golf, lac. Villas spacieuses avec cuisinettes. Avantages : Early Theme Park Entry, transport en bateau vers Disney Springs, spa Senses, golf, piscines paisibles, restaurants, villas tr√®s spacieuses.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas inspired by Victorian Saratoga Springs, NY hot springs. Elegant Victorian architecture, golf course, lake. Spacious villas with kitchenettes. Benefits: Early Theme Park Entry, boat transportation to Disney Springs, Senses Spa, golf, peaceful pools, restaurants, very spacious villas." },
            "Disney's Wilderness Lodge": { fr: "CAT√âGORIE DELUXE - Lodge rustique inspir√© des parcs nationaux am√©ricains avec architecture de rondins monumentale. Hall impressionnant avec chemin√©e g√©ante, geyser artificiel. Ambiance nature authentique. Avantages : Early Theme Park Entry, transport en bateau vers Magic Kingdom, piscines avec sources chaudes, restaurants signature, spa, programmes nature.", en: "DELUXE CATEGORY - Rustic lodge inspired by American national parks with monumental log architecture. Impressive lobby with giant fireplace, artificial geyser. Authentic nature atmosphere. Benefits: Early Theme Park Entry, boat transportation to Magic Kingdom, pools with hot springs, signature restaurants, spa, nature programs." },
            "Disney's Yacht Club Resort": { fr: "CAT√âGORIE DELUXE - H√¥tel nautique √©l√©gant inspir√© des yacht clubs de Nouvelle-Angleterre des ann√©es 1880. Architecture bleu et blanc sophistiqu√©e, ambiance maritime de luxe. Avantages : Early Theme Park Entry, acc√®s √† pied √† EPCOT et Hollywood Studios, Stormalong Bay (partag√©e avec Beach Club), restaurants signature, spa, plage, transport en bateau.", en: "DELUXE CATEGORY - Elegant nautical hotel inspired by 1880s New England yacht clubs. Sophisticated blue and white architecture, luxury maritime atmosphere. Benefits: Early Theme Park Entry, walking distance to EPCOT and Hollywood Studios, Stormalong Bay (shared with Beach Club), signature restaurants, spa, beach, boat transportation." },
            "Disney's Riviera Resort": { fr: "CAT√âGORIE DELUXE VILLA - Nouveau complexe Disney Vacation Club (2019) au th√®me de la Riviera europ√©enne avec art Disney. Architecture m√©diterran√©enne √©l√©gante, terrasse sur le toit. Villas modernes avec cuisinettes. Avantages : Early Theme Park Entry, Skyliner vers EPCOT/Hollywood Studios, restaurants raffin√©s dont rooftop, piscines avec toboggan, art Disney exclusif, villas contemporaines.", en: "DELUXE VILLA CATEGORY - New Disney Vacation Club resort (2019) with European Riviera theme featuring Disney art. Elegant Mediterranean architecture, rooftop terrace. Modern villas with kitchenettes. Benefits: Early Theme Park Entry, Skyliner to EPCOT/Hollywood Studios, refined restaurants including rooftop, pools with slide, exclusive Disney art, contemporary villas." },
            "The Cabins at Disney's Fort Wilderness Resort": { fr: "CAT√âGORIE MODERATE - Cabines rustiques dans une for√™t de 750 acres pour une exp√©rience de camping de luxe. Cabines avec cuisinettes compl√®tes, terrasses avec barbecue. Ambiance nature authentique avec cerfs et lapins. Avantages : Early Theme Park Entry, transport en bateau vers Magic Kingdom, activit√©s de plein air, feux de camp avec guimauves, piscines, location de v√©los et voiturettes de golf.", en: "MODERATE CATEGORY - Rustic cabins in 750-acre forest for luxury camping experience. Cabins with full kitchenettes, decks with grills. Authentic nature atmosphere with deer and rabbits. Benefits: Early Theme Park Entry, boat transportation to Magic Kingdom, outdoor activities, campfires with marshmallows, pools, bike and golf cart rentals." },
            "The Cabins at Disney's Fort Wilderness Resort ‚Äì A Disney Vacation Club Resort": { fr: "CAT√âGORIE DELUXE VILLA - Cabines Disney Vacation Club r√©nov√©es dans la for√™t de Fort Wilderness. Cabines spacieuses avec cuisinettes compl√®tes, terrasses dans la nature. Exp√©rience unique de 'glamping' Disney. Avantages : Early Theme Park Entry, transport en bateau vers Magic Kingdom, activit√©s nature, feux de camp Disney, piscines, vie sauvage, location d'√©quipements de plein air.", en: "DELUXE VILLA CATEGORY - Renovated Disney Vacation Club cabins in Fort Wilderness forest. Spacious cabins with full kitchenettes, nature decks. Unique Disney 'glamping' experience. Benefits: Early Theme Park Entry, boat transportation to Magic Kingdom, nature activities, Disney campfires, pools, wildlife, outdoor equipment rentals." },
            "Les terrains de camping au Disney's Fort Wilderness Resort": { fr: "CAT√âGORIE MODERATE - Terrains de camping dans une for√™t de 750 acres pour VR, roulottes et tentes. Sites avec hookups complets, certains en bord de lac. Exp√©rience camping authentique avec commodit√©s Disney. Avantages : Early Theme Park Entry, transport en bateau vers Magic Kingdom, activit√©s familiales, feux de camp avec personnages Disney, piscines, location d'√©quipements, magasins g√©n√©ral.", en: "MODERATE CATEGORY - Campgrounds in 750-acre forest for RVs, trailers and tents. Sites with full hookups, some lakefront. Authentic camping experience with Disney amenities. Benefits: Early Theme Park Entry, boat transportation to Magic Kingdom, family activities, campfires with Disney characters, pools, equipment rentals, general store." },
            "Les villas au Disney's Grand Floridian Resort & Spa": { fr: "CAT√âGORIE DELUXE VILLA - Villas Disney Vacation Club dans le plus prestigieux h√¥tel Disney avec √©l√©gance victorienne. Villas luxueuses avec cuisinettes, certaines avec vue sur Magic Kingdom. Service exceptionnel. Avantages : Early Theme Park Entry, monorail vers Magic Kingdom, restaurants gastronomiques, spa Senses complet, plage priv√©e, service de conciergerie, mariage Disney.", en: "DELUXE VILLA CATEGORY - Disney Vacation Club villas in Disney's most prestigious hotel with Victorian elegance. Luxurious villas with kitchenettes, some with Magic Kingdom views. Exceptional service. Benefits: Early Theme Park Entry, monorail to Magic Kingdom, gourmet restaurants, full Senses Spa, private beach, concierge service, Disney weddings." }
        };

        let compteurHotels = 0;

        document.getElementById('avionInclus').addEventListener('change', function() {
            const avionSection = document.getElementById('avionSection');
            avionSection.style.display = this.checked ? 'block' : 'none';
        });

        document.getElementById('billetSeulement').addEventListener('change', function() {
            const hotelSection = document.getElementById('hotelSection');
            hotelSection.style.display = this.checked ? 'none' : 'block';
            if(this.checked) { // If tickets only, ensure no hotels are showing or counted
                document.getElementById('hotelOptions').innerHTML = '';
                compteurHotels = 0;
            } else {
                if (compteurHotels === 0) ajouterHotel(); // If switching back and no hotels, add one
            }
        });

        function ajouterHotel() {
            compteurHotels++;
            const hotelDiv = document.createElement('div');
            hotelDiv.className = 'hotel-option';
            hotelDiv.id = `hotel${compteurHotels}`;
            
            hotelDiv.innerHTML = `
                <h4>H√¥tel ${compteurHotels}</h4>
                <div class="form-group">
                    <label>S√©lectionner l'h√¥tel :</label>
                    <select id="hotelSelect${compteurHotels}">
                        <option value="">-- Choisir un h√¥tel --</option>
                        ${hotelsList.map(hotel => `<option value="${hotel}">${hotel}</option>`).join('')}
                    </select>
                </div>
                <button type="button" class="remove-hotel-btn" onclick="supprimerHotel(${compteurHotels})">Supprimer</button>
            `;
            
            document.getElementById('hotelOptions').appendChild(hotelDiv);
        }

        function supprimerHotel(id) {
            const hotelDiv = document.getElementById(`hotel${id}`);
            if (hotelDiv) {
                hotelDiv.remove();
                // Optional: re-number remaining hotels if necessary, though not strictly required for functionality
            }
        }
        
        function formaterDescriptionHotel(description, langue) {
            if (!description) return "";
            let formattedDescription = "";

            const categorieKey = langue === 'fr' ? "CAT√âGORIE" : "CATEGORY";
            const avantagesKey = langue === 'fr' ? "Avantages :" : "Benefits:";
            
            // Regex to capture category (case-insensitive) up to " - "
            const categorieMatch = description.match(new RegExp(`^(${categorieKey}[^-]+?) - `, "i"));
            let restDescription = description;

            if (categorieMatch && categorieMatch[1]) {
                formattedDescription += `*${categorieMatch[1].trim()}*\n`; // Markdown for italics
                restDescription = description.substring(categorieMatch[0].length); // Get the rest of the string after the matched part
            }

            // Case-insensitive search for "Avantages" or "Benefits"
            const avantagesIndex = restDescription.toLowerCase().indexOf(avantagesKey.toLowerCase());
            if (avantagesIndex !== -1) {
                const mainDesc = restDescription.substring(0, avantagesIndex).trim();
                // Get the original casing of the "Avantages" key for display
                const originalAvantagesKey = restDescription.substring(avantagesIndex, avantagesIndex + avantagesKey.length);
                const avantagesText = restDescription.substring(avantagesIndex + avantagesKey.length).trim();

                if (mainDesc) formattedDescription += `${mainDesc}\n\n`; else formattedDescription += '\n';
                formattedDescription += `**${originalAvantagesKey}**\n`; // Markdown for bold
                
                // Split by comma, but try to be smart about commas within parentheses (e.g. for sizes)
                const avantagesList = avantagesText.split(/,\s*(?![^()]*\))/); 
                avantagesList.forEach(avantage => {
                    if (avantage.trim()) {
                       formattedDescription += `  - ${avantage.trim()}\n`;
                    }
                });
            } else {
                 if (restDescription.trim()) formattedDescription += `${restDescription.trim()}\n`;
            }
            return formattedDescription;
        }


        function obtenirDescriptionHotel(nomHotel, langue) {
            if (hotelDescriptions[nomHotel] && hotelDescriptions[nomHotel][langue]) {
                return hotelDescriptions[nomHotel][langue];
            }
            
            // Generic description if not found
            if (langue === 'fr') {
                return "CAT√âGORIE NON SP√âCIFI√âE - Un magnifique h√¥tel Disney offrant le confort et la magie Disney dans un cadre enchanteur. Avantages : Early Theme Park Entry.";
            } else {
                return "CATEGORY UNSPECIFIED - A beautiful Disney hotel offering comfort and Disney magic in an enchanting setting. Benefits: Early Theme Park Entry.";
            }
        }

        function genererCourriel() {
            const langue = document.getElementById('langue').value;
            const nomClient = document.getElementById('nomClient').value;
            const nbAdultes = document.getElementById('nbAdultes').value;
            const nbEnfants = document.getElementById('nbEnfants').value;
            const billetSeulement = document.getElementById('billetSeulement').checked;
            const avionInclus = document.getElementById('avionInclus').checked;
            const promotion = document.getElementById('promotion').value;
            const promotionDateFin = document.getElementById('promotionDateFin').checked;

            let courriel = ''; // This will be the plain text version

            // 1. Pr√©sentation
            if (langue === 'fr') {
                courriel += `Bonjour ${nomClient || '[Nom du client]'},\n\n`;
                courriel += `Je suis Pierre-Luc Morin, conseiller en voyages chez Voyages en Route, sp√©cialis√© en destinations Disney et Universal. Il me fera plaisir de vous aider dans la planification de votre voyage magique!\n\n`;
            } else {
                courriel += `Hello ${nomClient || '[Client Name]'},\n\n`;
                courriel += `I am Pierre-Luc Morin, travel advisor at Voyages en Route, specialized in Disney and Universal destinations. I will be delighted to help you plan your magical trip!\n\n`;
            }

            // 2. Votre voyage
            const titreVoyage = langue === 'fr' ? "VOTRE VOYAGE" : "YOUR TRIP";
            courriel += `${titreVoyage}\n\n`;

            if (billetSeulement) {
                if (langue === 'fr') {
                    courriel += `Vous trouverez en pi√®ce jointe la soumission avec les prix pour vos billets Disney seulement. Veuillez noter que tous les prix indiqu√©s sont en dollars am√©ricains (USD).\n\n`;
                } else {
                    courriel += `You will find attached the quote with prices for your Disney tickets only. Please note that all prices indicated are in US dollars (USD).\n\n`;
                }
            } else {
                const hotelsSelectionn√©s = [];
                for (let i = 1; i <= compteurHotels; i++) {
                    const selectElement = document.getElementById(`hotelSelect${i}`);
                    if (selectElement && selectElement.value) {
                        hotelsSelectionn√©s.push(selectElement.value);
                    }
                }

                if (hotelsSelectionn√©s.length > 0) {
                    if (langue === 'fr') {
                        if (hotelsSelectionn√©s.length === 1) {
                            courriel += `Vous trouverez en pi√®ce jointe la soumission avec les prix pour votre s√©jour.\n\n`;
                            courriel += `VOTRE H√îTEL : ${hotelsSelectionn√©s[0]}\n\n`;
                            const descHotel = obtenirDescriptionHotel(hotelsSelectionn√©s[0], 'fr');
                            courriel += formaterDescriptionHotel(descHotel, 'fr') + '\n';
                        } else {
                            courriel += `Vous trouverez en pi√®ces jointes les soumissions avec les prix pour vos diff√©rentes options d'h√©bergement.\n\n`;
                            hotelsSelectionn√©s.forEach((hotel, index) => {
                                courriel += `OPTION ${index + 1} : ${hotel}\n\n`;
                                const descHotel = obtenirDescriptionHotel(hotel, 'fr');
                                courriel += formaterDescriptionHotel(descHotel, 'fr') + '\n';
                            });
                        }
                    } else { // English
                        if (hotelsSelectionn√©s.length === 1) {
                            courriel += `You will find attached the quote with prices for your stay.\n\n`;
                            courriel += `YOUR HOTEL: ${hotelsSelectionn√©s[0]}\n\n`;
                            const descHotel = obtenirDescriptionHotel(hotelsSelectionn√©s[0], 'en');
                            courriel += formaterDescriptionHotel(descHotel, 'en') + '\n';
                        } else {
                            courriel += `You will find attached the quotes with prices for your different accommodation options.\n\n`;
                            hotelsSelectionn√©s.forEach((hotel, index) => {
                                courriel += `OPTION ${index + 1}: ${hotel}\n\n`;
                                const descHotel = obtenirDescriptionHotel(hotel, 'en');
                                courriel += formaterDescriptionHotel(descHotel, 'en') + '\n';
                            });
                        }
                    }
                     courriel += `\n`; // Add a newline after hotel block
                } else {
                     if (langue === 'fr') courriel += "Aucun h√¥tel s√©lectionn√©.\n\n";
                     else courriel += "No hotel selected.\n\n";
                }
                if (langue === 'fr') {
                    courriel += `Veuillez noter que tous les prix pour l'h√©bergement et les billets Disney sont en dollars am√©ricains (USD).\n\n`;
                } else {
                    courriel += `Please note that all prices for accommodation and Disney tickets are in US dollars (USD).\n\n`;
                }
            }

            // 3. Avion
            if (avionInclus) {
                const dateAller = document.getElementById('dateAller').value;
                const aeroportDepart = document.getElementById('aeroportDepart').value;
                const dateRetour = document.getElementById('dateRetour').value;
                const aeroportRetour = document.getElementById('aeroportRetour').value;
                const prixAvion = document.getElementById('prixAvion').value;
                const totalPersonnes = parseInt(nbAdultes) + parseInt(nbEnfants);

                if (langue === 'fr') {
                    courriel += `TRANSPORT A√âRIEN\n\n`;
                    courriel += `Aller : ${dateAller ? new Date(dateAller).toLocaleString('fr-CA', {dateStyle:'long', timeStyle:'short'}) : '[Date/heure √† d√©finir]'}\n`;
                    courriel += `De : ${aeroportDepart || '[A√©roport de d√©part]'}\n`;
                    courriel += `Vers : ${aeroportRetour || '[A√©roport de destination]'}\n\n`;
                    courriel += `Retour : ${dateRetour ? new Date(dateRetour).toLocaleString('fr-CA', {dateStyle:'long', timeStyle:'short'}) : '[Date/heure √† d√©finir]'}\n`;
                    courriel += `De : ${aeroportRetour || '[A√©roport de destination]'}\n`;
                    courriel += `Vers : ${aeroportDepart || '[A√©roport de d√©part]'}\n\n`;
                    courriel += `Nombre de passagers : ${totalPersonnes} (${nbAdultes} adulte${nbAdultes > 1 ? 's' : ''}${nbEnfants > 0 ? `, ${nbEnfants} enfant${nbEnfants > 1 ? 's' : ''}` : ''})\n`;
                    courriel += `Prix total approximatif : ${prixAvion || '[Prix]'} CAD\n\n`; // Corrected to CAD
                    courriel += `IMPORTANT : Les prix a√©riens sont sujets √† changement sans pr√©avis. Des frais de service de 50$ par personne sont applicables en surplus pour la r√©servation des vols. En cas de probl√®me avec vos vols, c'est moi qui m'en occupe pour vous. Si vous pr√©f√©rez r√©server vos vols de votre c√¥t√©, aucun frais ne s'applique sur la portion Disney de votre voyage, mais je ne pourrai pas vous offrir de support en cas de probl√®me.\n\n`;
                } else {
                    courriel += `AIR TRANSPORTATION\n\n`;
                    courriel += `Departure: ${dateAller ? new Date(dateAller).toLocaleString('en-CA', {dateStyle:'long', timeStyle:'short'}) : '[Date/time to be defined]'}\n`;
                    courriel += `From: ${aeroportDepart || '[Departure airport]'}\n`;
                    courriel += `To: ${aeroportRetour || '[Destination airport]'}\n\n`;
                    courriel += `Return: ${dateRetour ? new Date(dateRetour).toLocaleString('en-CA', {dateStyle:'long', timeStyle:'short'}) : '[Date/time to be defined]'}\n`;
                    courriel += `From: ${aeroportRetour || '[Destination airport]'}\n`;
                    courriel += `To: ${aeroportDepart || '[Departure airport]'}\n\n`;
                    courriel += `Number of passengers: ${totalPersonnes} (${nbAdultes} adult${nbAdultes > 1 ? 's' : ''}${nbEnfants > 0 ? `, ${nbEnfants} child${nbEnfants > 1 ? 'ren' : ''}` : ''})\n`;
                    courriel += `Approximate total price: ${prixAvion || '[Price]'} CAD\n\n`; // Corrected to CAD
                    courriel += `IMPORTANT: Airfare prices are subject to change without notice. Service fees of $50 per person apply in addition for flight bookings. In case of problems with your flights, I will take care of it for you. If you prefer to book your flights on your own, no fees apply to the Disney portion of your trip, but I cannot offer support in case of problems.\n\n`;
                }
            }

            // 4. Promotion
            if (promotion.trim()) {
                if (langue === 'fr') {
                    courriel += `PROMOTION APPLICABLE\n\n`;
                    courriel += `Bonne nouvelle! La promotion "${promotion}" est applicable √† votre r√©servation.`;
                    if (promotionDateFin) {
                        courriel += ` Cette promotion a une date de fin, il est donc important de r√©server rapidement pour en b√©n√©ficier.\n\n`;
                    } else {
                        courriel += ` Nous ne connaissons pas la date de fin de cette promotion pour le moment.\n\n`;
                    }
                } else {
                    courriel += `APPLICABLE PROMOTION\n\n`;
                    courriel += `Good news! The "${promotion}" promotion is applicable to your booking.`;
                    if (promotionDateFin) {
                        courriel += ` This promotion has an end date, so it's important to book quickly to benefit from it.\n\n`;
                    } else {
                        courriel += ` We don't know the end date of this promotion at the moment.\n\n`;
                    }
                }
            } else {
                if (langue === 'fr') {
                    courriel += `R√âSERVATION ET PROMOTIONS\n\n`;
                    courriel += `Si vous r√©servez maintenant, c'est 200 USD de d√©p√¥t et nous ferons appliquer les promotions disponibles d'ici le d√©part. Ce montant est remboursable jusqu'√† 30 jours avant le check-in.\n\n`;
                } else {
                    courriel += `BOOKING AND PROMOTIONS\n\n`;
                    courriel += `If you book now, it's a 200 USD deposit and we will apply available promotions before departure. This amount is refundable up to 30 days before check-in.\n\n`;
                }
            }

            // 5. La suite
            if (langue === 'fr') {
                courriel += `LA SUITE\n\n`;
                courriel += `Je vous laisse regarder et je reste disponible si vous avez des questions par courriel (r√©pondre √† ce courriel) ou par t√©l√©phone au 819-347-9103.\n\n`;
                courriel += `Merci de votre confiance et au plaisir de planifier votre voyage magique!\n\n`;
                courriel += `Pierre-Luc Morin\nConseiller en voyages\nVoyages en Route`;
            } else {
                courriel += `NEXT STEPS\n\n`;
                courriel += `Please take a look and I remain available if you have any questions by email (reply to this email) or by phone at 819-347-9103.\n\n`;
                courriel += `Thank you for your trust and looking forward to planning your magical trip!\n\n`;
                courriel += `Pierre-Luc Morin\nTravel Advisor\nVoyages en Route`;
            }

            // --- Apply styling for the preview pane ---
            const preview = document.getElementById('emailPreview');
            let styledCourriel = courriel; // Start with the plain text

            function escapeRegExpLocal(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }

            const mainTitlesFr = ["VOTRE VOYAGE", "TRANSPORT A√âRIEN", "PROMOTION APPLICABLE", "R√âSERVATION ET PROMOTIONS", "LA SUITE"];
            const mainTitlesEn = ["YOUR TRIP", "AIR TRANSPORTATION", "APPLICABLE PROMOTION", "BOOKING AND PROMOTIONS", "NEXT STEPS"];
            const allMainTitles = [...new Set([...mainTitlesFr, ...mainTitlesEn])];

            allMainTitles.forEach(title => {
                const titleRegex = new RegExp(`^(${escapeRegExpLocal(title)})$`, "gm");
                styledCourriel = styledCourriel.replace(titleRegex, (match) => {
                    let hr = '<hr style="border:0; border-top: 1px solid #eee; margin: 25px 0 15px 0;">';
                    // Avoid HR for the very first title if it's "VOTRE VOYAGE" and it's very close to the top
                    if ((match === "VOTRE VOYAGE" || match === "YOUR TRIP") && styledCourriel.indexOf(match) < (courriel.indexOf('\n\n') + 50) ) { 
                       // Check if it's the first main section title after the greeting
                       // No HR if it's the very first section directly after intro.
                    }
                    return `${hr}<div class="email-title">${match}</div>`;
                });
            });
            
            // Hotel name lines (VOTRE H√îTEL : Specific Hotel Name or OPTION X : Hotel Name)
            const hotelNameLineRegexFr = /^(VOTRE H√îTEL : .*|OPTION \d+ : .*)$/gm;
            styledCourriel = styledCourriel.replace(hotelNameLineRegexFr, '<div style="font-weight: bold; color: #2c3e50; margin-top: 15px; margin-bottom: 5px; font-size: 1.1em;">$1</div>');
            const hotelNameLineRegexEn = /^(YOUR HOTEL: .*|OPTION \d+: .*)$/gm;
            styledCourriel = styledCourriel.replace(hotelNameLineRegexEn, '<div style="font-weight: bold; color: #2c3e50; margin-top: 15px; margin-bottom: 5px; font-size: 1.1em;">$1</div>');
            
            // Convert markdown-like bold/italics from formaterDescriptionHotel to HTML for the preview
            styledCourriel = styledCourriel.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); // Bold
            styledCourriel = styledCourriel.replace(/\*(.*?)\*/g, '<em>$1</em>');         // Italics

            // The `.email-preview` div has `white-space: pre-wrap;` in CSS,
            // so newlines from the `courriel` string will be preserved automatically.
            preview.innerHTML = styledCourriel;
        }

        function copierCourriel() {
            const preview = document.getElementById('emailPreview');
            // Use innerText to get the plain text version, which is what `courriel` string holds effectively.
            // The HTML styling (<em>, <strong>, <div> for titles) is primarily for the preview div.
            // For email, simpler text is better. `innerText` will strip HTML tags.
            const texte = preview.innerText || preview.textContent; 
            
            navigator.clipboard.writeText(texte).then(function() {
                const btn = document.querySelector('.copy-btn');
                const originalText = btn.textContent;
                const lang = document.getElementById('langue').value;
                btn.textContent = lang === 'fr' ? '‚úÖ Copi√©!' : '‚úÖ Copied!';
                // Keep consistent background on copy success, or use a distinct success color
                btn.style.background = 'linear-gradient(135deg, #2ecc71, #27ae60)'; 
                
                setTimeout(function() {
                    btn.textContent = originalText;
                     // Revert to original copy button gradient
                    btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                }, 2000);
            }).catch(function(err) {
                console.error('Erreur lors de la copie: ', err);
                const lang = document.getElementById('langue').value;
                alert(lang === 'fr' ? 'Erreur lors de la copie. Veuillez s√©lectionner le texte manuellement.' : 'Error copying. Please select the text manually.');
            });
        }

        window.onload = function() {
            if (!document.getElementById('billetSeulement').checked) {
                 ajouterHotel(); // Add one hotel by default only if "billetSeulement" is not checked
            }
        };
    </script>
</body>
</html>
