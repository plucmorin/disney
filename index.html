<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur d'e-mail Disney (Version Finale)</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; margin: 20px; background-color: #f4f4f4; color: #333; line-height: 1.6; }
        .container { background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 900px; margin: auto;}
        h1 { text-align: center; margin-bottom: 30px; color: #0078C1; font-weight: 700;}
        h2 { margin-top: 25px; color: #0078C1; border-bottom: 2px solid #eee; padding-bottom: 8px;}
        label { display: block; margin-top: 15px; font-weight: 600; color: #333; }
        input[type="text"], input[type="number"], input[type="date"], input[type="time"], select, textarea {
            width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 1em;
        }
        textarea { resize: vertical; min-height: 80px; }
        input[type="checkbox"] { margin-right: 8px; vertical-align: middle; width: auto; }
        button, .remove-hotel-button {
            background-color: #007bff; color: white; padding: 12px 20px;
            border: none; border-radius: 6px; cursor: pointer; margin-top: 20px; font-size: 1.05em; font-weight: 500;
        }
        button:hover { background-color: #0056b3; }
        .remove-hotel-button { background-color: #dc3545; padding: 5px 10px; font-size: 0.9em; margin-left: 10px; margin-top: 0;}
        .form-section { border: 1px solid #e9ecef; padding: 20px; margin-bottom: 25px; border-radius: 8px; background-color: #fdfdfd; }
        .hotel-option-group { border: 1px solid #e0e0e0; padding: 15px; margin-top: 15px; border-radius: 8px; background-color: #fafafa; }
        .hotel-option-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .hidden { display: none; }
        #emailOutputContainer { margin-top: 30px; }
        #emailOutput { padding: 20px; border: 1px solid #ccc; background-color: #f0f2f5; border-radius: 8px; min-height: 200px; overflow-x: auto;}
        .flight-inputs { border: 1px solid #ddd; border-radius: 8px; padding: 10px 15px 15px 15px; margin-top:10px; }
        .flight-option-group { border: 1px solid #e0e0e0; padding: 15px; margin-top: 15px; border-radius: 8px; background-color: #fafafa; }
    </style>
</head>
<body>
    <div class="container">
        <h1>G√©n√©rateur d'e-mail Disney</h1>
        <form id="disneyForm">
            <div class="form-section">
                <h2>Informations G√©n√©rales</h2>
                <label for="client_name">Nom de la personne cliente&nbsp;:</label>
                <input type="text" id="client_name" name="client_name" placeholder="Entrez le nom du client" required>
                <label for="adults">Nombre d'adultes&nbsp;:</label>
                <input type="number" id="adults" name="adults" min="1" value="2" required>
                <label for="children">Nombre d'enfants (0 si aucun)&nbsp;:</label>
                <input type="number" id="children" name="children" min="0" value="0" required>
            </div>
            <div class="form-section">
                <h2>H√©bergement et Billets</h2>
                <label for="booking_type">Type de r√©servation&nbsp;:</label>
                <select id="booking_type" name="booking_type">
                    <option value="hotel_tickets">H√¥tel + Billets</option>
                    <option value="tickets_only">Billets seulement</option>
                </select>
                <div id="hotel_options_container">
                    <div id="hotel_selections"></div>
                    <button type="button" id="add_hotel_button">Ajouter une option d'h√¥tel</button>
                </div>
            </div>
            <div class="form-section">
                <h2>Vols</h2>
                <label><input type="checkbox" id="include_flights" name="include_flights"> Inclure les vols&nbsp;?</label>
                <div id="flight_details" class="hidden">
                    <label><input type="checkbox" id="flight_too_early" name="flight_too_early"> Il est trop t√¥t pour r√©server les vols (nous surveillons les itin√©raires)</label>
                    <div id="flight_options_section">
                        <label for="flight_option_count">Nombre d'options de vol&nbsp;:</label>
                        <select id="flight_option_count" name="flight_option_count">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div id="flight_option_groups"></div>
                        <div id="multiple_flight_reason" class="hidden">
                            <label for="flight_multiple_reason">Pourquoi plusieurs options&nbsp;:</label>
                            <textarea id="flight_multiple_reason" name="flight_multiple_reason" placeholder="Expliquez la raison des multiples choix"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-section">
                <h2>Promotion</h2>
                <label for="promotion_type">Type de promotion&nbsp;:</label>
                <select id="promotion_type" name="promotion_type">
                    <option value="aucune">Aucune promotion pour l'instant</option>
                    <option value="specifique">Promotion sp√©cifique</option>
                </select>
                <div id="promotion_details" class="hidden">
                    <label for="promotion_name">Nom de la promotion&nbsp;:</label>
                    <input type="text" id="promotion_name" name="promotion_name" placeholder="Nom de la promotion (ex: Rabais estival)">
                    <label for="promotion_end_date">Date de fin de la promotion (si applicable)&nbsp;:</label>
                    <input type="date" id="promotion_end_date" name="promotion_end_date">
                </div>
            </div>
            <button type="submit">G√©n√©rer l'e-mail</button>
        </form>

        <div id="emailOutputContainer">
            <h2>E-mail G√©n√©r√© (Pr√™t √† copier)</h2>
            <div id="emailOutput" contenteditable="true"></div>
            <button type="button" id="copyHtmlButton">Copier le contenu de l'e-mail</button>
        </div>
    </div>

    <script>
        const DISNEY_HOTELS = [
             // Deluxe Villas
            { name: "Bay Lake Tower at Contemporary", description: "Ce croissant de lune moderne adjacent au Contemporary offre des villas luxueuses et une vue imprenable sur Magic Kingdom. Son sky-bridge le connecte directement √† l'h√¥tel principal et au monorail.", level: "Deluxe Villa", pointsForts: ["Distance de marche de Magic Kingdom", "Acc√®s √† la ligne du monorail", "Vues spectaculaires sur les feux d'artifice", "Piscine priv√©e avec glissade d'eau"] },
            { name: "Villas at Grand Floridian", description: "Le summum du luxe et de l'√©l√©gance victorienne dans un format de villa spacieuse. Profitez du service impeccable et des restaurants prim√©s du Grand Floridian, le tout sur la ligne du monorail.", level: "Deluxe Villa", pointsForts: ["H√©bergement le plus luxueux de Disney", "Restaurants gastronomiques sur place", "Spa Senses de classe mondiale", "Acc√®s direct au monorail"] },
            { name: "Polynesian Villas & Bungalows", description: "√âvadez-vous dans un paradis tropical avec ces villas et bungalows sur l'eau. L'ambiance des √Æles du Pacifique Sud, la vue sur le lagon et l'acc√®s au monorail en font une escapade de r√™ve.", level: "Deluxe Villa", pointsForts: ["Bungalows uniques sur pilotis", "Ambiance tropicale immersive", "Situ√© sur la ligne du monorail", "Excellents restaurants th√©matiques ('Ohana)"] },
            { name: "BoardWalk Villas", description: "Revivez le charme d'une promenade c√¥ti√®re du d√©but du XXe si√®cle. Ces villas offrent un acc√®s direct √† l'animation effervescente du BoardWalk, avec ses restaurants, boutiques et spectacles de rue.", level: "Deluxe Villa", pointsForts: ["Distance de marche de EPCOT et Hollywood Studios", "Vie nocturne et restaurants sur le BoardWalk", "Piscine Luna Park sur le th√®me du cirque", "Service de bateau-taxi (Friendship)"] },
            { name: "Beach Club Villas", description: "Profitez de l'ambiance d√©contract√©e d'une villa de la Nouvelle-Angleterre. Le point d'orgue est Stormalong Bay, un incroyable complexe aquatique de 3 acres avec fond de sable et rivi√®re tranquille.", level: "Deluxe Villa", pointsForts: ["Acc√®s √† la meilleure piscine de Disney World", "√Ä quelques pas de l'entr√©e d'EPCOT", "Atmosph√®re baln√©aire relaxante", "Restaurant populaire Beaches & Cream"] },
            { name: "Riviera Resort", description: "Inspir√© par l'√©l√©gance de la Riviera europ√©enne, cet h√¥tel sophistiqu√© allie le glamour europ√©en √† la magie de Disney. Ses studios et villas offrent des vues magnifiques et une d√©coration raffin√©e.", level: "Deluxe Villa", pointsForts: ["Station principale du Disney Skyliner", "Restaurant sur le toit avec personnages (Topolino's)", "Design europ√©en √©l√©gant et artistique", "Piscines magnifiques et jeux d'eau"] },
            { name: "Wilderness Lodge - Copper Creek Villas", description: "Inspir√©es par l'h√©ritage ferroviaire du Nord-Ouest Pacifique, ces villas et cabines au bord de l'eau offrent une touche de luxe moderne dans un cadre rustique et sauvage.", level: "Deluxe Villa", pointsForts: ["Cabines priv√©es luxueuses au bord du lac", "Piscine th√©matique avec geyser", "Ambiance √† la fois rustique et moderne", "Acc√®s par bateau-taxi √† Magic Kingdom"] },
            { name: "Wilderness Lodge - Boulder Ridge Villas", description: "Adjacent au lodge principal, ce b√¢timent √©voque le charme des g√Ætes des parcs nationaux de l'Ouest am√©ricain. Une ambiance chaleureuse et rustique, parfaite pour une retraite paisible.", level: "Deluxe Villa", pointsForts: ["Atmosph√®re calme et plus intime", "Th√®me des parcs nationaux am√©ricains", "Acc√®s facile aux commodit√©s du lodge", "Feu de camp et activit√©s ext√©rieures"] },
            { name: "Animal Kingdom Lodge - Jambo House Villas", description: "Vivez une exp√©rience immersive dans le b√¢timent principal d'Animal Kingdom Lodge. Le lobby grandiose et les vues directes sur la savane depuis certaines villas sont inoubliables.", level: "Deluxe Villa", pointsForts: ["Vues imprenables sur la savane animali√®re", "Lobby spectaculaire et collection d'art africain", "Acc√®s aux restaurants prim√©s (Jiko, Boma)", "Piscine Uzima avec vue sur les animaux"] },
            { name: "Animal Kingdom Lodge - Kidani Village", description: "Ce b√¢timent d√©di√© aux villas offre une ambiance plus calme et des vues √©tendues sur la savane. Id√©al pour les familles qui souhaitent plus d'espace et une cuisine compl√®te.", level: "Deluxe Villa", pointsForts: ["Excellent pour l'observation des animaux", "Piscine Samawati avec glissades et jeux d'eau", "Restaurant Sanaa avec vue sur la savane", "Villas spacieuses avec cuisines compl√®tes"] },
            { name: "Saratoga Springs Resort & Spa", description: "Inspir√© par la ville thermale historique de Saratoga Springs, ce complexe de style victorien propose des villas, un spa complet, et un acc√®s facile √† Disney Springs par bateau ou √† pied.", level: "Deluxe Villa", pointsForts: ["Distance de marche de Disney Springs", "Treehouse Villas uniques en leur genre", "Parcours de golf sur place (Lake Buena Vista)", "Ambiance de station thermale relaxante"] },
            { name: "Old Key West Resort", description: "√âvoquant l'ambiance d√©contract√©e de Key West, ce vaste complexe propose des villas parmi les plus spacieuses du site, de magnifiques fairways et une atmosph√®re de communaut√© insulaire.", level: "Deluxe Villa", pointsForts: ["Villas extr√™mement spacieuses", "Ambiance d√©contract√©e et luxuriante", "Restaurant Olivia's Caf√© (un classique)", "Transport par bateau vers Disney Springs"] },

            // Deluxe Resorts
            { name: "Contemporary Resort", description: "Iconique et ultra-moderne, cet h√¥tel en forme de A est le seul o√π le monorail passe directement √† l'int√©rieur. Il est si proche de Magic Kingdom que vous pouvez y aller √† pied.", level: "Deluxe", pointsForts: ["Le plus proche de Magic Kingdom (√† pied)", "Le monorail traverse le lobby de l'h√¥tel", "Restaurant sur le toit (California Grill)", "Design moderne et vues exceptionnelles"] },
            { name: "Grand Floridian Resort & Spa", description: "L'h√¥tel le plus luxueux et embl√©matique de Disney. Son √©l√©gance victorienne, son service impeccable, son spa de renomm√©e mondiale et sa proximit√© avec Magic Kingdom en font le summum du luxe.", level: "Deluxe", pointsForts: ["Service 5 √©toiles et √©l√©gance victorienne", "Spa Senses de classe mondiale", "Restaurants gastronomiques (Victoria & Albert's)", "Sur la ligne du monorail vers Magic Kingdom"] },
            { name: "Polynesian Village Resort", description: "Une escapade tropicale luxuriante qui vous transporte dans les √Æles du Pacifique Sud. Profitez de son ambiance exotique, de sa plage de sable blanc avec vue sur le ch√¢teau et de son acc√®s direct au monorail.", level: "Deluxe", pointsForts: ["Ambiance des √Æles du Pacifique Sud", "Vue sur les feux d'artifice de Magic Kingdom", "Acc√®s au monorail et aux bateaux-taxis", "Restaurant populaire 'Ohana"] },
            { name: "Wilderness Lodge", description: "Inspir√© des grands lodges des parcs nationaux am√©ricains, ce complexe majestueux est un chef-d'≈ìuvre d'artisanat. Son lobby spectaculaire avec une chemin√©e de 82 pieds et son geyser en font une destination en soi.", level: "Deluxe", pointsForts: ["Lobby et architecture spectaculaires", "Ambiance immersive de parc national", "Transport par bateau vers Magic Kingdom", "Piscine avec geyser 'Fire Rock'"] },
            { name: "Yacht Club Resort", description: "Plongez dans l'√©l√©gance nautique d'un club de yacht de la Nouvelle-Angleterre. Son atmosph√®re est plus formelle que son h√¥tel jumeau, le Beach Club, avec qui il partage l'exceptionnelle piscine Stormalong Bay.", level: "Deluxe", pointsForts: ["Partage l'acc√®s √† la piscine Stormalong Bay", "Restaurant signature (Yachtsman Steakhouse)", "Atmosph√®re nautique et raffin√©e", "Distance de marche d'EPCOT"] },
            { name: "Beach Club Resort", description: "Avec son ambiance d√©contract√©e de station baln√©aire de la Nouvelle-Angleterre, cet h√¥tel est un favori des familles. Son atout majeur est l'acc√®s √† Stormalong Bay, un mini parc aquatique avec fond de sable.", level: "Deluxe", pointsForts: ["Acc√®s au complexe aquatique Stormalong Bay", "Le plus pr√®s de l'entr√©e d'EPCOT (√† pied)", "Ambiance familiale et ensoleill√©e", "Glaces et repas au Beaches & Cream"] },
            { name: "BoardWalk Inn", description: "Cet h√¥tel charmant vous transporte sur une promenade c√¥ti√®re des ann√©es 1920. Le soir, le 'Boardwalk' s'anime avec ses restaurants, ses artistes de rue et sa vie nocturne, le tout √† quelques pas d'EPCOT.", level: "Deluxe", pointsForts: ["Acc√®s √† pied √† EPCOT et Hollywood Studios", "Promenade anim√©e avec restaurants et spectacles", "Piscine 'Luna Park' sur le th√®me du carnaval", "√âl√©gance d'une √©poque r√©volue"] },
            { name: "Animal Kingdom Lodge", description: "√âvadez-vous dans un lodge africain authentique o√π l'aventure vous attend √† votre fen√™tre. Cet h√¥tel majestueux est entour√© de savanes luxuriantes, offrant des vues sur plus de 30 esp√®ces d'animaux.", level: "Deluxe", pointsForts: ["Vues spectaculaires sur la savane animali√®re", "Collection d'art africain de calibre mondial", "Restaurants th√©matiques exceptionnels (Jiko, Boma)", "Immersion culturelle unique"] },
            
            // Moderate Resorts
            { name: "Coronado Springs Resort", description: "Ce complexe tentaculaire allie une architecture coloniale espagnole √† l'√©l√©gance moderne de la tour Gran Destino. Il offre des commodit√©s de luxe √† un prix de cat√©gorie mod√©r√©e.", level: "Moderate", pointsForts: ["Ambiance de luxe √† prix mod√©r√©", "Options de restauration vari√©es et excellentes", "Piscine 'The Lost City of Cibola' avec pyramide", "La tour Gran Destino offre des chambres modernes"] },
            { name: "Caribbean Beach Resort", description: "√âvadez-vous dans l'ambiance color√©e et tropicale des Cara√Øbes. Ce resort tentaculaire est le hub central du Disney Skyliner, offrant un transport rapide et amusant vers deux parcs.", level: "Moderate", pointsForts: ["Hub principal du Disney Skyliner", "Piscine th√©matique 'Fuentes del Morro'", "Chambres sur le th√®me des pirates", "Ambiance de vacances tropicales"] },
            { name: "Port Orleans - French Quarter", description: "Ce charmant h√¥tel √©voque les rues pav√©es et les balcons en fer forg√© du Vieux Carr√© de La Nouvelle-Orl√©ans. Sa petite taille le rend intime et facile √† parcourir, avec un seul arr√™t d'autobus.", level: "Moderate", pointsForts: ["H√¥tel le plus compact et intime", "Beignets Mickey frais et d√©licieux", "Ambiance jazz et romantique", "Service de bateau-taxi vers Disney Springs"] },
            { name: "Port Orleans - Riverside", description: "Explorez les bayous rustiques de la Louisiane ou les manoirs √©l√©gants du Sud. Ce vaste complexe offre une grande vari√©t√© de paysages et une atmosph√®re paisible au bord de la rivi√®re.", level: "Moderate", pointsForts: ["Choix entre manoirs ou cabanes rustiques", "Chambres th√©matiques 'Royal Rooms'", "Atmosph√®re relaxante au bord de la rivi√®re", "Activit√©s comme la p√™che et les cal√®ches"] },
            { name: "The Cabins at Fort Wilderness", description: "Offrant une v√©ritable immersion dans la nature, ces cabines rustiques sont nich√©es dans une for√™t de 750 acres. Chaque cabine peut loger jusqu‚Äô√† six personnes et dispose d'une cuisine compl√®te.", level: "Moderate", pointsForts: ["Cuisine compl√®te et barbecue priv√©", "Immersion totale dans la nature", "Nombreuses activit√©s r√©cr√©atives", "Peut accueillir jusqu'√† 6 personnes"] },
            
            // Value Resorts
            { name: "Art of Animation Resort", description: "Plongez litt√©ralement dans les mondes de N√©mo, Cars, Le Roi Lion et La Petite Sir√®ne. Cet h√¥tel est c√©l√®bre pour ses suites familiales immersives et sa piscine 'Big Blue', la plus grande de Disney World.", level: "Value", pointsForts: ["Suites familiales th√©matiques (jusqu'√† 6 pers.)", "La plus grande piscine de tout Disney World", "Station d√©di√©e sur le Disney Skyliner", "D√©cors et personnages g√©ants spectaculaires"] },
            { name: "Pop Century Resort", description: "Voyagez √† travers les d√©cennies marquantes du XXe si√®cle. Cet h√¥tel est l'un des favoris pour son excellent rapport qualit√©-prix et son acc√®s direct et rapide au Disney Skyliner.", level: "Value", pointsForts: ["Acc√®s direct au Disney Skyliner", "Excellent rapport qualit√©-prix", "R√©cemment r√©nov√© avec lits queen", "Ambiance nostalgique et amusante"] },
            { name: "All-Star Movies Resort", description: "Vibrez au rythme des classiques du cin√©ma Disney dans cet h√¥tel aux d√©cors spectaculaires. Id√©al pour les familles, chaque b√¢timent est une c√©l√©bration de films comme Fantasia ou Toy Story.", level: "Value", pointsForts: ["Th√©matisation immersive et ic√¥nes g√©antes", "L'une des options les plus abordables sur site", "Grande aire de restauration 'World Premiere'", "Piscine sur le th√®me de Fantasia"] },
            { name: "All-Star Music Resort", description: "C√©l√©brez tous les genres musicaux, du calypso au rock'n'roll. C'est le seul h√¥tel 'All-Star' √† proposer des suites familiales, une option √©conomique pour les grands groupes.", level: "Value", pointsForts: ["Propose des suites familiales abordables", "Piscine principale en forme de guitare", "Th√®me musical entra√Ænant et amusant", "Excellent choix pour les fanfares scolaires"] },
            { name: "All-Star Sports Resort", description: "Pour les amateurs de sport, cet h√¥tel est un terrain de jeu g√©ant. Les ic√¥nes surdimensionn√©es de ballons de football, de battes de baseball et de planches de surf cr√©ent une atmosph√®re √©nergique.", level: "Value", pointsForts: ["Th√®me sportif et dynamique", "Parfait pour les groupes sportifs de jeunes", "Tarifs parmi les plus bas de Disney", "Aires de jeux sur le th√®me du sport"] }
        ];

        function getHotelByName(name) { return DISNEY_HOTELS.find(hotel => hotel.name === name); }
        function formatDateFR(dateStr) { if (!dateStr) return ""; try { const date = new Date(dateStr + 'T00:00:00'); const options = { year: 'numeric', month: 'long', day: 'numeric' }; return date.toLocaleDateString('fr-FR', options); } catch (e) { return dateStr; } }
        function formatTime(timeStr) { if (!timeStr) return ""; try { const [hours, minutes] = timeStr.split(':'); return `${String(hours).padStart(2, '0')}h${String(minutes).padStart(2, '0')}`; } catch (e) { return timeStr; } }

function generateEmailHTML(data) {
    // Updated color palette for better contrast and dark mode support
    const C = {
        blue: '#0078C1',
        blueDark: '#005a9c',
        orange: '#FF6B35', // Better contrast than #FF7F50
        textDark: '#1a1a1a', // Better than pure black
        textLight: '#666666', // Better contrast
        border: '#EAEAEA',
        background: '#f8f8f8', // Slightly off-white
        white: '#FFFFFF',
        blueLight: '#e6f2fa',
        orangeLight: '#fff4e6',
        level: { value: '#28a745', moderate: '#2196F3', deluxe: '#6f42c1', deluxe_villa: '#9C27B0' },
        tags: ['#0078C1', '#5A67D8', '#d9480f', '#0ca678']
    };

    const S = {
        fontStack: `-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif`,
        p: `font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 16px; line-height: 24px; color: ${C.textDark}; margin: 16px 0; text-align: left; mso-line-height-rule: exactly;`,
        strong: `font-weight: 600; color: ${C.textDark};`,
        italic: `font-style: italic;`,
    };

    const LOGOS = {
        earmarked: "https://boisterous-rabanadas-5fcb72.netlify.app/Logo_Fond_Blanc_2.png",
        agency: "https://boisterous-rabanadas-5fcb72.netlify.app/Disney-EarMarked.png"
    };
    
    function createBanner(text, type = 'main') {
        let style, titleStyle, wrapperStyle;
        switch (type) {
            case 'closing': 
                style = `background-color: ${C.orange}; padding: 12px 30px;`; 
                titleStyle = `font-family: Georgia, serif; font-size: 24px; color: ${C.white}; font-weight: bold; text-transform: uppercase; margin: 0; text-align: center; letter-spacing: 1px; mso-line-height-rule: exactly;`; 
                wrapperStyle = `padding: 5px 0;`; 
                break;
            case 'sub': 
                style = `background-color: ${C.blue}; padding: 10px 30px;`; 
                titleStyle = `font-family: ${S.fontStack}; font-size: 20px; color: ${C.white}; font-weight: bold; text-transform: uppercase; margin: 0; text-align: center; mso-line-height-rule: exactly;`; 
                wrapperStyle = `padding: 0;`; 
                break;
            case 'main': 
            default: 
                style = `background-color: ${C.blue}; padding: 25px 30px;`; 
                titleStyle = `font-family: Georgia, serif; font-size: 32px; color: ${C.white}; font-weight: bold; text-transform: uppercase; margin: 0; text-align: center; letter-spacing: 1.5px; line-height: 36px; mso-line-height-rule: exactly;`; 
                wrapperStyle = `padding: 10px 0;`; 
                break;
        }
        return `<tr><td style="${style}"><div style="${wrapperStyle}"><h1 style="${titleStyle}">${text}</h1></div></td></tr>`;
    }
    
    function createCalloutBox(title, text, color) {
        const bgColor = color === 'orange' ? '#FFF9F5' : '#F0F8FF';
        const borderColor = C[color] || C.blue;
        return `<table width="100%" border="0" cellpadding="0" cellspacing="0" role="presentation" style="margin-top:20px;"><tr><td style="padding: 20px 25px; background-color: ${bgColor}; border-left: 5px solid ${borderColor}; border-radius: 0 8px 8px 0;"><h2 style="font-family:${S.fontStack}; font-size:18px; color:${borderColor}; margin:0 0 10px 0; font-weight:bold; mso-line-height-rule: exactly;">${title}</h2><p style="font-family:${S.fontStack}; font-size: 15px; line-height: 22px; color: ${C.textDark}; margin:0; text-align:left; mso-line-height-rule: exactly;">${text}</p></td></tr></table>`;
    }

    // Keep all the French text exactly the same
    const T = {
        banner1: "Votre Aventure Magique Commence Ici",
        greeting: `Bonjour <strong style="${S.strong}">${data.client_name || 'estim√©(e) voyageur(se)'}</strong>,`,
        intro1: `Je vous √©cris au nom de Voyages en Route, o√π nous avons le plaisir d'accompagner les familles et voyageurs dans la planification de leurs s√©jours. Je m'appelle Pierre-Luc Morin et je serais votre conseiller en voyages sp√©cialis√© en destinations <strong style="${S.strong}">Disney et Universal</strong>.`,
        intro2: `Merci de nous avoir confi√© votre projet de voyage. J'ai pris soin de pr√©parer une proposition bas√©e sur les crit√®res que vous avez partag√©s dans votre demande. Cette soumission est <strong style="${S.strong}">ajustable</strong>, et je serai heureux d'explorer avec vous diff√©rentes options afin de vous cr√©er une exp√©rience <strong style="${S.strong}">propre √† vous et inoubliable</strong>.`,
        disney_advantages_intro: `S√©journer dans un h√¥tel Disney, c'est profiter d'un univers immersif du matin au soir, mais aussi de <strong style="${S.strong}">nombreux avantages exclusifs</strong>&nbsp;:</p>`,
        disney_advantages_list_items: [
            `<strong style="${S.strong}">L'Early Theme Park Entry</strong>, pour acc√©der aux parcs avant l'ouverture officielle&nbsp;;`,
            `Le <strong style="${S.strong}">transport gratuit</strong> vers tous les parcs et sites Disney (excluant les transferts a√©roports)&nbsp;;`,
            `L'<strong style="${S.strong}">acc√®s simplifi√©</strong> aux r√©servations avec l'application Disney Experience&nbsp;;`,
            `Et un <strong style="${S.strong}">service client exceptionnel</strong>, sign√© Disney, √† chaque √©tape de votre s√©jour.`
        ],
        disney_price_disclaimer: "Veuillez noter que tous les prix pour l'h√©bergement et les billets Disney sont indiqu√©s en dollars am√©ricains (USD) et sont sujets √† disponibilit√©.",
        tickets_only_price_disclaimer: "Veuillez noter que tous les prix des billets Disney sont indiqu√©s en dollars am√©ricains (USD) et sont sujets √† disponibilit√©.",
        banner_travel_fees: "Itin√©raire de Vol",
        flight_intro: "Pour compl√©ter votre voyage vers la magie, voici les d√©tails concernant le transport a√©rien que nous avons explor√©&nbsp;:",
        flight_too_early: "Il est encore un peu t√¥t pour r√©server les vols, car plusieurs compagnies a√©riennes n'ont pas encore publi√© leurs horaires. Cela dit, nous suivons la situation de pr√®s afin de vous proposer les meilleures options d√®s qu'elles seront disponibles. N'h√©sitez pas √† me faire part de vos pr√©f√©rences en mati√®re d'horaires ou de compagnies, pour que je puisse mieux cibler ce qui vous conviendrait le mieux.",
        flight_price_info: `<em style="${S.italic}">Les prix sont √† titre indicatif et peuvent changer √† tout moment.</em>`,
        flight_important_label: `IMPORTANT`,
        flight_important_text: `Les tarifs a√©riens sont dynamiques et peuvent changer jusqu'√† la r√©servation. Des frais de service de <strong style="${S.strong}">50$ CAD par personne</strong> s'appliquent pour la r√©servation des vols via nos services. En me confiant vos vols, je m'occupe de tout d√©sagr√©ment potentiel. Si vous optez pour une r√©servation personnelle, ces frais ne s'appliquent pas, mais le support en cas de probl√®me avec les vols ne sera pas inclus pour cette portion.`,
        banner_magic_continues: "La Magie Continue...",
        closing1: `Prenez le temps de r√™ver √† ces options et de consid√©rer ce qui ferait de ce voyage une exp√©rience <strong style="${S.strong}">v√©ritablement inoubliable</strong>. Je suis √† votre <strong style="${S.strong}">enti√®re disposition</strong> pour r√©pondre √† toutes vos questions, affiner chaque d√©tail ou proc√©der √† la r√©servation de cette <em style="${S.italic}">aventure m√©morable</em>.`,
        closing2: `N'h√©sitez pas √† me joindre par courriel (en r√©pondant simplement √† celui-ci) ou par t√©l√©phone au <strong style="${S.strong}">819-347-9103</strong>. <strong style="${S.strong}"><em style="${S.italic}">Merci de me faire savoir si le message a bien √©t√© re√ßu</em></strong>.`,
        closing3: `Merci encore pour votre confiance. J'ai sinc√®rement h√¢te de transformer ce <strong style="${S.strong}">r√™ve Disney</strong> en une <strong style="${S.strong}">magnifique r√©alit√© pour vous&nbsp;!</strong>`
    };
    
    let introSection = `<p style="${S.p}">${T.greeting}</p><p style="${S.p}">${T.intro1}</p><p style="${S.p}">${T.intro2}</p>`;
    let hotelSection = '';
    const selectedHotels = data.hotels || [];

    if (data.booking_type === 'hotel_tickets' && selectedHotels.length > 0) {
        if (selectedHotels.length === 1) {
            const hotel = selectedHotels[0];
            const levelColor = C.level[hotel.level.toLowerCase().replace(/ /g, '_')] || C.textLight;
            
            let prosList = `<span style="background-color:${levelColor}; color:${C.white}; padding: 5px 12px; margin: 0 8px 8px 0; border-radius: 15px; font-size: 14px; font-weight: 600; display:inline-block;">${hotel.level}</span>`;
            hotel.pointsForts.forEach((p, i) => {
                const tagColor = C.tags[i % C.tags.length];
                prosList += `<span style="display:inline-block; background-color:${tagColor}; color:${C.white}; padding: 5px 12px; margin: 0 8px 8px 0; border-radius: 15px; font-size: 14px; font-weight: 600;">${p}</span>`;
            });

            let hotelCard = `
                <table width="100%" border="0" cellpadding="0" cellspacing="0" role="presentation" style="margin-top: 25px; border: 1px solid ${C.border}; border-radius: 8px;">
                    <tr>
                        <td style="background-color:${C.blue}; color:${C.white}; padding:15px 20px; border-radius: 8px 8px 0 0;">
                            <strong style="font-family:${S.fontStack}; font-size:20px; color:${C.white};">${hotel.name}</strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="background-color:${C.white}; padding: 20px;">
                            <p style="font-family:${S.fontStack}; font-size:15px; line-height:22px; color:${C.textLight}; margin:0 0 15px 0; text-align:left; mso-line-height-rule: exactly;">${hotel.description}</p>
                            <div style="padding:10px 0;">${prosList}</div>
                        </td>
                    </tr>
                    <tr>
                        <td style="background-color:${C.blueLight}; padding: 15px 20px; text-align:center; border-radius: 0 0 8px 8px; border-top: 1px solid ${C.border};">
                            <span style="font-size:14px; color:${C.textLight}; font-weight:600; text-transform:uppercase;">PRIX DU FORFAIT</span><br>
                            <strong style="font-size:28px; color:${C.textDark}; line-height:32px;">${hotel.price ? hotel.price + '&nbsp;USD' : 'Voir PDF'}</strong>
                        </td>
                    </tr>
                </table>
            `;
            hotelSection += `<p style="${S.p}">Pour votre s√©jour, voici l'option que j'ai s√©lectionn√©e pour vous :</p>${hotelCard}`;
        } else {
            hotelSection += `<p style="${S.p}">Voici plusieurs options d'h√©bergement pour votre s√©jour. Chaque proposition ci-dessous correspond √† un forfait d√©taill√© dans un document PDF distinct.</p>`;
            selectedHotels.forEach(hotel => {
                const levelColor = C.level[hotel.level.toLowerCase().replace(/ /g, '_')] || C.textLight;
                
                let prosList = `<span style="background-color:${levelColor}; color:${C.white}; padding: 5px 12px; margin: 0 8px 8px 0; border-radius: 15px; font-size: 14px; font-weight: 600; display:inline-block;">${hotel.level}</span>`;
                hotel.pointsForts.forEach((p, i) => {
                    const tagColor = C.tags[i % C.tags.length];
                    prosList += `<span style="display:inline-block; background-color:${tagColor}; color:${C.white}; padding: 5px 12px; margin: 0 8px 8px 0; border-radius: 15px; font-size: 14px; font-weight: 600;">${p}</span>`;
                });

                hotelSection += `
                    <table width="100%" border="0" cellpadding="0" cellspacing="0" role="presentation" style="margin-top: 25px; border: 1px solid ${C.border}; border-radius: 8px;">
                        <tr>
                            <td style="background-color:${C.blue}; color:${C.white}; padding:15px 20px; border-radius: 8px 8px 0 0;">
                                <strong style="font-family:${S.fontStack}; font-size:20px; color:${C.white};">${hotel.name}</strong>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color:${C.white}; padding: 20px;">
                                <p style="font-family:${S.fontStack}; font-size:15px; line-height:22px; color:${C.textLight}; margin:0 0 15px 0; text-align:left; mso-line-height-rule: exactly;">${hotel.description}</p>
                                <div style="padding:10px 0;">${prosList}</div>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color:${C.blueLight}; padding: 15px 20px; text-align:center; border-radius: 0 0 8px 8px; border-top: 1px solid ${C.border};">
                                <span style="font-size:14px; color:${C.textLight}; font-weight:600; text-transform:uppercase;">PRIX DU FORFAIT</span><br>
                                <strong style="font-size:28px; color:${C.textDark}; line-height:32px;">${hotel.price ? hotel.price + '&nbsp;USD' : 'Voir PDF'}</strong>
                            </td>
                        </tr>
                    </table>
                `;
            });
        }
        
        hotelSection += `<p style="${S.p} margin-top:20px;">Chaque proposition de forfait inclut l'h√©bergement √† l'h√¥tel ainsi que les billets d'entr√©e pour les parcs Disney. Tous les autres d√©tails, inclusions et conditions se trouvent dans le ou les documents PDF correspondants.</p>`
        let advantagesList = T.disney_advantages_list_items.map(item => `<li style="margin-bottom:8px;"><span style="color:${C.blue}; font-size:18px; vertical-align:middle; margin-right:8px; font-weight:bold;">&#10004;</span><span style="vertical-align:middle;">${item}</span></li>`).join('');
        hotelSection += `<p style="${S.p} margin-top:30px; text-align:left;">${T.disney_advantages_intro}<ul style="margin:16px 0; padding:0; list-style-type:none; text-align:left;">${advantagesList}</ul>`;

    } else if (data.booking_type === 'tickets_only') {
        hotelSection = `<p style="${S.p}">J'ai pr√©par√© pour vous un document ci-joint indiquant le prix ainsi que les conditions applicables aux billets de parc.</p>`;
    }

    let promoText = "";
    if (data.promotion_type === 'aucune') {
        promoText = `Pour garantir votre place, un d√©p√¥t de seulement <strong style="${S.strong}">200 USD</strong> est requis. Les promotions Disney deviennent souvent disponibles et sont parfois compl√®tement r√©serv√©es √† l'int√©rieur de quelques heures. Il est donc important de r√©server d'avance pour que je sois en mesure de les obtenir pour vous de mani√®re rapide et syst√©matique, afin que vous ayez toujours le meilleur rapport qualit√©-prix. Le reste de la balance de paiement est aussi √† effectuer 30 jours avant le check-in.`;
    } else {
        let promoEndDateInfo = data.promotion_end_date ? ` (prend fin le <strong style="${S.strong}">${formatDateFR(data.promotion_end_date)}</strong>)` : "";
        let promoNameInfo = data.promotion_name ? `&nbsp;: <strong style="${S.strong}">${data.promotion_name}</strong>` : "";
        promoText = `Une promotion est applicable pour votre s√©jour${promoNameInfo}${promoEndDateInfo}. L'offre est cependant <em style="${S.italic}">limit√©e</em>. Pour garantir votre place au c≈ìur de la magie, un d√©p√¥t de seulement <strong style="${S.strong}">200 USD</strong> est requis. Ce d√©p√¥t est <strong style="${S.strong}">enti√®rement remboursable jusqu'√† 30 jours avant votre arriv√©e</strong>, vous offrant une flexibilit√© totale. Le reste de la balance de paiement est aussi √† effectuer 30 jours avant le check-in.`;
    }
    
    let promotionSection = createCalloutBox("PROMOTIONS ET D√âP√îT REQUIS", promoText, "orange");
    let priceDisclaimer = (data.booking_type === 'hotel_tickets' && selectedHotels.length > 0) ? T.disney_price_disclaimer : T.tickets_only_price_disclaimer;

    let flightSection = '';
    let flightBlock = '';
    if (data.include_flights) {
        const hasFlightInfo = [
            data.departure_date_aller,
            data.departure_time_aller,
            data.departure_airport_aller,
            data.arrival_airport_aller,
            data.flight_multiple_reason,
            ...(data.flights || []).flatMap(f => Object.values(f))
        ].some(v => v && v.toString().trim() !== '');

        if (hasFlightInfo) {
            const arrow = `<span style="color:${C.orange}; font-weight:bold; font-size:24px; line-height:1;">&nbsp;&rarr;&nbsp;</span>`;

            let flightDetails = '';
            if (data.flight_too_early) {
                flightDetails = `<p style="${S.p}">${T.flight_too_early}</p>`;
            } else {
                flightDetails = `<p style="${S.p}">${T.flight_intro}</p>`;
                if ((data.flights || []).length > 1 && data.flight_multiple_reason) {
                    flightDetails += `<p style="${S.p} font-style:italic;">${data.flight_multiple_reason.replace(/\n/g,'<br>')}</p>`;
                }

                (data.flights || []).forEach((f, idx) => {
                    flightDetails += `<table width="100%" border="0" cellpadding="0" cellspacing="0" role="presentation" style="border: 1px solid #e0e0e0; padding: 15px; margin-top: 15px; border-radius: 8px; background-color: #fafafa;">`;
                    if ((data.flights || []).length > 1) {
                        flightDetails += `<tr><td><strong>Option ${idx + 1}</strong></td></tr>`;
                    }
                    
                    // Vol aller
                    flightDetails += `
                        <tr><td style="padding-top: 10px;">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0" role="presentation" style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; background-color: ${C.white};">
                                <tr><td colspan="3"><h3 style="margin: 0 0 15px 0; font-family: ${S.fontStack}; color: ${C.textDark};">Vol aller</h3></td></tr>
                                <tr>
                                    <td width="45%" style="text-align:center; vertical-align:top;">
                                        <div style="font-size:16px; color:${C.textLight}; text-transform:uppercase; margin-bottom:10px;">D√©part</div>
                                        <div style="font-size:20px; font-weight:bold; color:${C.blue}; margin-bottom:10px;">${f.departure_airport_aller || 'N/A'}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üìÖ&nbsp;${formatDateFR(f.departure_date_aller)}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üïí&nbsp;${formatTime(f.departure_time_aller)}</div>
                                    </td>
                                    <td width="10%" style="text-align:center; vertical-align:middle;">${arrow}</td>
                                    <td width="45%" style="text-align:center; vertical-align:top;">
                                        <div style="font-size:16px; color:${C.textLight}; text-transform:uppercase; margin-bottom:10px;">Arriv√©e</div>
                                        <div style="font-size:20px; font-weight:bold; color:${C.blue}; margin-bottom:10px;">${f.arrival_airport_aller || 'N/A'}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üìÖ&nbsp;${formatDateFR(f.arrival_date_aller)}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üïí&nbsp;${formatTime(f.arrival_time_aller)}</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="padding-top:10px; text-align:center;">
                                        <div style="font-size:14px; color:${C.textLight}; line-height:20px;">${f.airline_aller || ''}<br>${f.flight_number_aller || ''}</div>
                                    </td>
                                </tr>
                            </table>
                        </td></tr>
                    `;
                    
                    // Vol retour
                    flightDetails += `
                        <tr><td style="padding-top: 10px;">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0" role="presentation" style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; background-color: ${C.white};">
                                <tr><td colspan="3"><h3 style="margin: 0 0 15px 0; font-family: ${S.fontStack}; color: ${C.textDark};">Vol retour</h3></td></tr>
                                <tr>
                                    <td width="45%" style="text-align:center; vertical-align:top;">
                                        <div style="font-size:16px; color:${C.textLight}; text-transform:uppercase; margin-bottom:10px;">D√©part</div>
                                        <div style="font-size:20px; font-weight:bold; color:${C.blue}; margin-bottom:10px;">${f.departure_airport_retour || 'N/A'}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üìÖ&nbsp;${formatDateFR(f.departure_date_retour)}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üïí&nbsp;${formatTime(f.departure_time_retour)}</div>
                                    </td>
                                    <td width="10%" style="text-align:center; vertical-align:middle;">${arrow}</td>
                                    <td width="45%" style="text-align:center; vertical-align:top;">
                                        <div style="font-size:16px; color:${C.textLight}; text-transform:uppercase; margin-bottom:10px;">Arriv√©e</div>
                                        <div style="font-size:20px; font-weight:bold; color:${C.blue}; margin-bottom:10px;">${f.arrival_airport_retour || 'N/A'}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üìÖ&nbsp;${formatDateFR(f.arrival_date_retour)}</div>
                                        <div style="font-size:14px; color:${C.textDark};">üïí&nbsp;${formatTime(f.arrival_time_retour)}</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="padding-top:10px; text-align:center;">
                                        <div style="font-size:14px; color:${C.textLight}; line-height:20px;">${f.airline_retour || ''}<br>${f.flight_number_retour || ''}</div>
                                    </td>
                                </tr>
                            </table>
                        </td></tr>
                    `;
                    
                    // Prix
                    flightDetails += `
                        <tr><td style="padding-top: 10px;">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0" role="presentation" style="background-color:${C.blueLight}; padding: 15px 20px; text-align:center; border-radius: 8px;">
                                <tr>
                                    <td>
                                        <span style="font-size:14px; color:${C.textLight}; font-weight:600; text-transform:uppercase;">PRIX APPROXIMATIF DES VOLS</span><br>
                                        <strong style="font-size:28px; color:${C.textDark}; line-height:32px;">${f.flight_price ? f.flight_price + '&nbsp;CAD' : 'N/A'}</strong>
                                    </td>
                                </tr>
                            </table>
                        </td></tr>
                    `;
                    
                    if (f.flight_notes) {
                        flightDetails += `<tr><td style="padding-top: 10px;"><p style="${S.p} font-style:italic; font-weight:600; color:${C.textLight}; border-left:3px solid ${C.border}; padding-left:15px;">${f.flight_notes.replace(/\n/g,'<br>')}</p></td></tr>`;
                    }
                    flightDetails += `</table>`;
                });

                flightDetails += createCalloutBox(T.flight_important_label, T.flight_important_text, 'orange');
                flightDetails += `<p style="${S.p} font-size:14px; color:${C.textLight}; text-align:left; margin-top:20px;">${T.flight_price_info}</p>`;
            }

            flightSection = `<tr><td style="padding: 20px 30px 30px 30px;">${flightDetails}</td></tr>`;
            flightBlock = `${createBanner(T.banner_travel_fees, 'sub')}${flightSection}`;
        }
    }

    let closingSection = `<p style="${S.p}">${T.closing1}</p><p style="${S.p}">${T.closing2}</p><p style="${S.p}">${T.closing3}</p>`;
    
    const hotelBannerText = data.booking_type === 'tickets_only' ? "Billets de Parc Disney" : "Forfaits H√¥tel & Billets Disney";

    // Updated HTML with better dark mode support
    return `<!DOCTYPE html>
<html lang="fr" xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no, url=no">
    <meta name="x-apple-disable-message-reformatting">
    <meta name="color-scheme" content="light dark">
    <meta name="supported-color-schemes" content="light dark">
    <title>${T.banner1}</title>
    <!--[if gte mso 9]>
    <xml>
        <o:OfficeDocumentSettings>
            <o:AllowPNG/>
            <o:PixelsPerInch>96</o:PixelsPerInch>
        </o:OfficeDocumentSettings>
    </xml>
    <![endif]-->
    <style>
        :root {
            color-scheme: light dark;
            supported-color-schemes: light dark;
        }
        body {
            margin: 0;
            padding: 0;
            word-spacing: normal;
            background-color: #f8f8f8;
        }
        table {
            border-collapse: collapse;
            border-spacing: 0;
        }
        td {
            padding: 0;
        }
        img {
            height: auto;
            outline: none;
            text-decoration: none;
            -ms-interpolation-mode: bicubic;
        }
        /* Dark mode styles */
        @media (prefers-color-scheme: dark) {
            body { background-color: #1e1e1e !important; }
            .email-body { background-color: #2d2d2d !important; }
            .content-bg { background-color: #2d2d2d !important; }
            .text-dark { color: #f0f0f0 !important; }
            .text-light { color: #cccccc !important; }
            .bg-light { background-color: #3d3d3d !important; }
            .border-color { border-color: #444444 !important; }
            .logo-bg { background-color: #1a1a1a !important; }
            .logo-container-bg { background-color: #2d2d2d !important; }
            h1, h2, h3, p, span, strong { color: #f0f0f0 !important; }
            .banner-blue { background-color: #1a5490 !important; }
            .banner-orange { background-color: #cc5500 !important; }
        }
        /* Mobile styles */
        @media screen and (max-width: 600px) {
            .email-container { width: 100% !important; }
            .padding-mobile { padding: 20px 15px !important; }
        }
    </style>
</head>
<body style="margin: 0; padding: 0; background-color: #f8f8f8; word-spacing: normal;">
    <div role="article" aria-roledescription="email" lang="fr" style="text-size-adjust: 100%; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;">
        <!--[if mso | IE]>
        <table role="presentation" border="0" cellpadding="0" cellspacing="0" width="100%" style="background-color: #f8f8f8;">
        <tr>
        <td>
        <![endif]-->
        <table align="center" role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin: 0 auto;">
            <tr>
                <td align="center">
                    <table class="email-container" role="presentation" cellspacing="0" cellpadding="0" border="0" width="680" style="margin: 20px auto; background-color: #ffffff; width: 680px; max-width: 100%;">
                        <!-- Logo Header -->
                        <tr>
                            <td class="logo-bg" align="center" style="padding: 20px 0; background-color: #001f3f;">
                                <table class="logo-container-bg" border="0" cellpadding="0" cellspacing="0" role="presentation" style="background-color: #e9f2f9; padding: 20px 30px; border-radius: 8px; max-width: 420px;">
                                    <tr>
                                        <td align="center" width="50%">
                                            <img src="${LOGOS.earmarked}" alt="Logo Earmarked" width="150" style="display: block; max-width: 150px; width: 100%; height: auto;">
                                        </td>
                                        <td align="center" width="50%">
                                            <img src="${LOGOS.agency}" alt="Logo agence" width="150" style="display: block; max-width: 150px; width: 100%; height: auto;">
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        
                        <!-- Main Banner -->
                        ${createBanner(T.banner1, 'main')}
                        
                        <!-- Introduction -->
                        <tr>
                            <td class="content-bg padding-mobile" style="padding: 20px 30px 30px 30px; background-color: #ffffff;">
                                ${introSection}
                            </td>
                        </tr>
                        
                        <!-- Hotel Section -->
                        ${createBanner(hotelBannerText, 'sub')}
                        <tr>
                            <td class="content-bg padding-mobile" style="padding: 20px 30px 10px 30px; background-color: #ffffff;">
                                ${hotelSection}
                            </td>
                        </tr>
                        
                        <!-- Promotion Section -->
                        <tr>
                            <td class="content-bg padding-mobile" style="padding: 10px 30px 30px 30px; background-color: #ffffff;">
                                ${promotionSection}
                            </td>
                        </tr>
                        
                        <!-- Price Disclaimer -->
                        <tr>
                            <td class="content-bg padding-mobile" style="padding: 0 30px 30px 30px; background-color: #ffffff;">
                                <p style="${S.p} font-size:14px; color:${C.textLight}; text-align:center; ${S.italic}">${priceDisclaimer}</p>
                            </td>
                        </tr>
                        
                        <!-- Flight Section -->
                        ${flightBlock}
                        
                        <!-- Closing Banner -->
                        ${createBanner(T.banner_magic_continues, 'closing')}
                        
                        <!-- Closing Text -->
                        <tr>
                            <td class="content-bg padding-mobile" style="padding: 20px 30px 30px 30px; background-color: #ffffff;">
                                ${closingSection}
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <!--[if mso | IE]>
        </td>
        </tr>
        </table>
        <![endif]-->
    </div>
</body>
</html>`;
}
