<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Générateur d'e-mail Disney (Logo Option A)</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f4; color: #333; line-height: 1.6; }
        .container { background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); max-width: 900px; margin: auto;}
        h1 { text-align: center; margin-bottom: 30px; color: #007bff;}
        h2 { margin-top: 25px; color: #007bff; border-bottom: 1px solid #eee; padding-bottom: 5px;}
        label { display: block; margin-top: 15px; font-weight: bold; }
        input[type="text"], input[type="number"], input[type="date"], input[type="time"], select, textarea {
            width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;
        }
        input[type="checkbox"] { margin-right: 5px; vertical-align: middle; }
        button, .remove-hotel-button {
            background-color: #007bff; color: white; padding: 10px 15px;
            border: none; border-radius: 4px; cursor: pointer; margin-top: 10px; font-size: 0.95em;
        }
        button:hover, .remove-hotel-button:hover { background-color: #0056b3; }
        .remove-hotel-button { background-color: #dc3545; margin-left:10px; }
        .remove-hotel-button:hover { background-color: #c82333; }
        .form-section { border: 1px solid #eee; padding: 15px; margin-bottom: 20px; border-radius: 5px; background-color: #fdfdfd; }
        .hidden { display: none; }
        #emailOutputContainer { margin-top: 30px; }
        #emailOutput { padding: 20px; border: 1px solid #ccc; background-color: #f0f0f0; border-radius: 5px; min-height: 200px; }
        .hotel-selection { display: flex; align-items: center; margin-bottom: 10px; }
        .hotel-selection select { flex-grow: 1; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Générateur d'e-mail pour Voyages Disney</h1>
        <form id="disneyForm">
            <div class="form-section">
                <h2>Informations Générales</h2>
                <label for="client_name">Nom de la personne cliente :</label>
                <input type="text" id="client_name" name="client_name" placeholder="Entrez le nom du client" required>
                <label for="adults">Nombre d'adultes :</label>
                <input type="number" id="adults" name="adults" min="1" value="2" required>
                <label for="children">Nombre d'enfants (0 si aucun) :</label>
                <input type="number" id="children" name="children" min="0" value="0" required>
            </div>
            <div class="form-section">
                <h2>Hébergement et Billets</h2>
                <label for="booking_type">Type de réservation :</label>
                <select id="booking_type" name="booking_type">
                    <option value="hotel_tickets">Hôtel + Billets</option>
                    <option value="tickets_only">Billets seulement</option>
                </select>
                <div id="hotel_options_container">
                    <label>Choix d'hôtel(s) :</label>
                    <div id="hotel_selections"></div>
                    <button type="button" id="add_hotel_button">Ajouter une option d'hôtel</button>
                </div>
            </div>
            <div class="form-section">
                <h2>Vols</h2>
                <label><input type="checkbox" id="include_flights" name="include_flights"> Inclure les vols ?</label>
                <div id="flight_details" class="hidden">
                    <label for="departure_date_aller">Date de départ (Aller) :</label>
                    <input type="date" id="departure_date_aller" name="departure_date_aller">
                    <label for="departure_time_aller">Heure de départ (Aller) :</label>
                    <input type="time" id="departure_time_aller" name="departure_time_aller">
                    <label for="departure_airport_aller">Aéroport de départ (Aller) :</label>
                    <input type="text" id="departure_airport_aller" name="departure_airport_aller" placeholder="Ex: YUL - Montréal">
                    <label for="arrival_airport_aller">Aéroport d'arrivée (Aller) :</label>
                    <input type="text" id="arrival_airport_aller" name="arrival_airport_aller" placeholder="Ex: MCO - Orlando" value="MCO - Orlando">
                    <label for="departure_date_retour">Date de départ (Retour) :</label>
                    <input type="date" id="departure_date_retour" name="departure_date_retour">
                    <label for="departure_time_retour">Heure de départ (Retour) :</label>
                    <input type="time" id="departure_time_retour" name="departure_time_retour">
                    <label for="departure_airport_retour">Aéroport de départ (Retour) :</label>
                    <input type="text" id="departure_airport_retour" name="departure_airport_retour" placeholder="Ex: MCO - Orlando" value="MCO - Orlando">
                    <label for="arrival_airport_retour">Aéroport d'arrivée (Retour) :</label>
                    <input type="text" id="arrival_airport_retour" name="arrival_airport_retour" placeholder="Ex: YUL - Montréal">
                    <label for="flight_price">Prix total approximatif des vols (CAD) :</label>
                    <input type="number" id="flight_price" name="flight_price" step="0.01">
                </div>
            </div>
            <div class="form-section">
                <h2>Promotion</h2>
                <label for="promotion_type">Type de promotion :</label>
                <select id="promotion_type" name="promotion_type">
                    <option value="aucune">Aucune promotion pour l'instant</option>
                    <option value="specifique">Promotion spécifique</option>
                </select>
                <div id="promotion_details" class="hidden">
                    <label for="promotion_name">Nom de la promotion :</label>
                    <input type="text" id="promotion_name" name="promotion_name" placeholder="Nom de la promotion (ex: Rabais estival)">
                    <label for="promotion_end_date">Date de fin de la promotion (si applicable) :</label>
                    <input type="date" id="promotion_end_date" name="promotion_end_date">
                </div>
            </div>
            <button type="submit">Générer l'e-mail</button>
        </form>

        <div id="emailOutputContainer">
            <h2>E-mail Généré (Prêt à copier)</h2>
            <p><em><b>Important :</b> La police "Aptos" ne s'affichera que si le destinataire l'a installée... Testez l'envoi.</em></p>
            <div id="emailOutput" contenteditable="true"></div>
            <button type="button" id="copyHtmlButton">Copier le contenu de l'e-mail</button>
        </div>
    </div>

    <script>
        const DISNEY_HOTELS = [ /* ... Votre liste d'hôtels ici ... */ 
            { name: "Bay Lake Tower at Disney's Contemporary Resort", description: "Connecté au Magic Kingdom par une passerelle, cet hôtel moderne offre des vues spectaculaires et des villas luxueuses." },
            { name: "Boulder Ridge Villas at Disney's Wilderness Lodge", description: "Inspirées par les gîtes des parcs nationaux de l'Ouest américain de la fin du XIXe siècle, ces villas offrent un charme rustique et une ambiance chaleureuse." },
            { name: "Copper Creek Villas & Cabins at Disney's Wilderness Lodge", description: "Des villas et cabines élégantes au bord de l'eau, offrant un mélange de luxe moderne et de nature sauvage, inspirées par l'héritage ferroviaire du Nord-Ouest Pacifique." },
            { name: "Disney’s All-Star Movies Resort", description: "Plongez dans la magie du cinéma avec cet hôtel thématique qui rend hommage aux grands classiques d’animation de Disney, comme Toy Story, 101 Dalmatiens ou Fantasia. Les bâtiments colorés et les immenses statues de personnages emblématiques en font un lieu très apprécié des familles. Parmi les commodités offertes : deux piscines thématiques, une aire de jeux pour enfants, une arcade et une aire de restauration variée. Le transport vers les quatre parcs thématiques, les parcs aquatiques et Disney Springs est assuré uniquement par autobus." },
            { name: "Disney’s All-Star Music Resort", description: "Inspiré de différents genres musicaux comme le jazz, le rock, le calypso et le country, cet hôtel immersif propose des bâtiments décorés d’instruments géants et une ambiance rythmée. Il dispose de deux piscines thématiques (dont l'une en forme de guitare), d’un food court, d’une salle d’arcade, et propose des suites familiales dans certaines sections. Le transport est uniquement offert par autobus vers tous les parcs et destinations Disney." },
            { name: "Disney’s All-Star Sports Resort", description: "Idéal pour les amateurs d’activités physiques, cet hôtel célèbre les grands sports américains comme le football, le basketball, le tennis ou le baseball, avec des décorations géantes et une ambiance énergique. On y trouve deux piscines thématiques, une aire de restauration, une arcade, ainsi que des terrains pour s’amuser entre les visites. Le transport est offert par autobus vers tous les parcs et Disney Springs." },
            { name: "Disney’s Animal Kingdom Lodge", description: "Plongez dans l’univers africain avec ce lodge spectaculaire inspiré des hôtels safari. Le point fort : des savanes où vous pouvez observer plus de 30 espèces d’animaux depuis votre balcon ou les espaces communs. L’hôtel propose des restaurants renommés comme Boma et Jiko, une grande piscine avec toboggan, une aire de jeux aquatique pour enfants, et un centre de remise en forme. Le transport vers les parcs Disney se fait uniquement par autobus." },
            { name: "Disney’s Animal Kingdom Villas - Jambo House", description: "Faisant partie de l'Animal Kingdom Lodge, Jambo House offre des vues sur la savane, une architecture africaine authentique et un accès facile aux restaurants et commodités du lodge principal." },
            { name: "Disney’s Animal Kingdom Villas - Kidani Village", description: "Adjacent à Jambo House, Kidani Village propose principalement des villas DVC avec des vues étendues sur la savane, une piscine dédiée avec toboggan et le restaurant Sanaa." },
            { name: "Disney’s Art of Animation Resort", description: "Cet hôtel transporte les visiteurs dans les mondes colorés de La Petite Sirène, Le Roi Lion, Némo et Cars, avec des décors grandeur nature, des suites thématiques immersives et des détails visuels spectaculaires. Les familles y trouvent des suites spacieuses, la plus grande piscine de Walt Disney World (inspirée de Némo), une aire de restauration variée et une zone de jeux aquatiques pour les enfants. Le Disney Skyliner est accessible directement depuis l’hôtel, permettant de se rendre à EPCOT et à Disney’s Hollywood Studios en gondole aérienne." },
            { name: "Disney’s Beach Club Resort", description: "Ce charmant hôtel d’inspiration Nouvelle-Angleterre, avec ses couleurs pastel et ses façades élégantes, est particulièrement populaire pour sa piscine Stormalong Bay : un mini-parc aquatique avec sable au fond, rivière lente et toboggan. On y trouve également plusieurs restaurants, des courts de tennis et une salle de sport. Situé à quelques minutes à pied d’EPCOT, il offre aussi un accès par bateau à Hollywood Studios et des autobus vers les autres destinations." },
            { name: "Disney’s Beach Club Villas", description: "Partageant les commodités du Beach Club Resort, ces villas offrent plus d'espace et de flexibilité, y compris des cuisines, tout en conservant l'atmosphère balnéaire élégante." },
            { name: "Disney’s BoardWalk Inn", description: "Cet hôtel rappelle les promenades côtières des années 1920, avec une ambiance festive et animée en soirée grâce à son boardwalk rempli de restaurants, boutiques, artistes de rue et boîtes de nuit. L’hôtel dispose de piscines thématiques, d’un spa, d’un centre de remise en forme, et de restaurants comme Flying Fish. Vous pouvez marcher jusqu’à EPCOT, prendre un bateau pour Hollywood Studios, et utiliser les autobus pour les autres parcs." },
            { name: "Disney’s BoardWalk Villas", description: "Ces villas offrent le charme du BoardWalk Inn avec des hébergements plus spacieux, parfaits pour les familles, et un accès direct à l'animation du BoardWalk." },
            { name: "Disney’s Caribbean Beach Resort", description: "Ce vaste complexe vous transporte dans l’ambiance relaxante des Caraïbes, avec ses plages artificielles, ses palmiers et ses bâtiments colorés représentant différentes îles comme la Barbade ou Trinité. L’hôtel propose une piscine principale sur le thème d’un fort espagnol, plusieurs piscines secondaires, des restaurants comme le Sebastian’s Bistro, et des promenades au bord de l’eau. Il s'agit également du nœud principal du Disney Skyliner, avec des trajets vers EPCOT et Hollywood Studios directement depuis la station centrale." },
            { name: "Disney’s Contemporary Resort", description: "Un des hôtels les plus iconiques de Disney, reconnaissable à sa structure en forme de A traversée par le monorail. Cet hôtel moderne et élégant offre un accès à pied au parc Magic Kingdom en moins de 10 minutes, en plus du monorail vers EPCOT. Les commodités incluent une grande piscine, un spa, un centre de conférence, et le célèbre restaurant California Grill, avec vue sur les feux d’artifice." },
            { name: "Disney’s Coronado Springs Resort", description: "Mariant l’architecture espagnole coloniale et l’élégance d’un hôtel de congrès moderne, Coronado Springs propose une ambiance sophistiquée. Le complexe inclut la tour Gran Destino (moderne et luxueuse), une immense piscine à thème maya avec toboggan, plusieurs restaurants (dont Toledo, en rooftop), un centre de remise en forme et des salles de conférence. Bien que haut de gamme, les transports sont offerts uniquement par autobus vers tous les parcs et lieux Disney." },
            { name: "Disney’s Grand Floridian Resort & Spa", description: "L’hôtel le plus luxueux de Disney, inspiré des stations balnéaires victoriennes, propose une ambiance élégante avec chandeliers, musique en direct au piano et service haut de gamme. Il dispose d’un spa complet, de plusieurs piscines, d’un centre de remise en forme et de restaurants de renom comme Victoria & Albert’s et Narcoossee’s. Le Grand Floridian est connecté par monorail et bateau à Magic Kingdom, et par monorail (avec correspondance) à EPCOT." },
            { name: "Disney’s Old Key West Resort", description: "Évoquant l'ambiance décontractée de Key West, ce vaste complexe propose des villas spacieuses, des terrains de golf, des piscines tranquilles et un service de bateau vers Disney Springs." },
            { name: "Disney’s Polynesian Village Resort", description: "Ambiance tropicale, torches enflammées, et bâtiments inspirés des îles du Pacifique vous attendent dans cet hôtel emblématique de Disney. On y trouve des restaurants très appréciés comme ‘Ohana et Kona Café, une plage avec vue sur les feux de Magic Kingdom, une piscine thématique avec toboggan, et des spectacles polynésiens. Il est relié par monorail et bateau à Magic Kingdom, et par monorail avec correspondance à EPCOT." },
            { name: "Disney's Polynesian Villas & Bungalows", description: "Des villas et des bungalows sur pilotis luxueux offrant une expérience polynésienne ultime, avec un accès facile aux commodités du Polynesian Village Resort." },
            { name: "Disney’s Pop Century Resort", description: "Remontez le temps à travers les décennies du 20e siècle avec cet hôtel coloré qui célèbre la culture populaire des années 1950 à 1990. Les bâtiments sont ornés d’objets emblématiques de chaque époque, comme des disques vinyles, des yo-yos géants ou des téléphones rétro. Le complexe propose des piscines thématiques, un food court, une boutique de souvenirs et des services de transport. Il est relié au Disney Skyliner, vous offrant un accès rapide à EPCOT et à Hollywood Studios." },
            { name: "Disney’s Port Orleans Resort - French Quarter", description: "Ce charmant hôtel évoque le Vieux Carré de La Nouvelle-Orléans avec ses rues pavées, ses balcons en fer forgé et son ambiance jazz. Il s'agit du plus petit hôtel Disney, idéal pour ceux qui veulent un séjour paisible. Les commodités comprennent une piscine avec un toboggan en forme de serpent géant, des beignets faits maison au Scat Cat’s Café, et une promenade en bateau pittoresque vers Disney Springs. Le reste du transport (vers les parcs thématiques) se fait par autobus." },
            { name: "Disney’s Port Orleans Resort - Riverside", description: "Ce complexe est divisé en deux sections : Magnolia Bend (grands manoirs inspirés des plantations du Sud) et Alligator Bayou (cabines rustiques et boisées). Il propose des piscines, des activités comme la pêche, des balades en calèche, et des restaurants comme Boatwright’s Dining Hall. Un bateau mène à Disney Springs, tandis que les autres destinations Disney sont desservies par autobus." },
            { name: "Disney’s Saratoga Springs Resort & Spa", description: "Inspiré par la ville thermale historique de Saratoga Springs dans l'État de New York, ce complexe de style victorien propose des villas, un spa, des terrains de golf et un accès facile à Disney Springs par bateau ou à pied." },
            { name: "Disney’s Wilderness Lodge", description: "Inspiré des grands lodges des parcs nationaux américains, ce complexe majestueux propose un décor rustique en bois et pierre, une cheminée monumentale et des sentiers dans la forêt. On y retrouve une piscine à cascades, des feux de camp, un geyser artificiel, et des restaurants comme Whispering Canyon Café. Il est accessible à Magic Kingdom en bateau, et aux autres parcs par autobus." },
            { name: "Disney’s Yacht Club Resort", description: "Voisin du Beach Club et partageant avec lui l’accès à Stormalong Bay, cet hôtel présente une esthétique nautique raffinée avec boiseries sombres et ambiance yacht club de Nouvelle-Angleterre. Il propose des restaurants comme Yachtsman Steakhouse, une salle de sport, et des sports nautiques. Vous pouvez marcher jusqu’à EPCOT, prendre un bateau pour Hollywood Studios, ou un autobus pour les autres destinations." },
            { name: "Disney’s Riviera Resort", description: "Inspiré par l'élégance de la Riviera européenne, cet hôtel propose des studios et des villas, des restaurants sophistiqués (comme Topolino's Terrace), et un accès direct au Disney Skyliner." },
            { name: "The Cabins at Disney's Fort Wilderness Resort", description: "Offrant une véritable immersion dans la nature, ces cabines rustiques sont nichées dans une forêt de 750 acres. Chaque cabine peut loger jusqu’à six personnes, avec une cuisine équipée, une terrasse et un barbecue. Le complexe propose du tir à l’arc, des feux de camp avec personnages Disney, des spectacles de style western et des randonnées. Le transport se fait en autobus interne, puis en bateau jusqu’à Magic Kingdom, ou en autobus vers les autres parcs." },
            { name: "The Cabins at Disney's Fort Wilderness Resort – A Disney Vacation Club Resort", description: "Ces cabines, faisant partie du Disney Vacation Club, offrent les mêmes avantages que les cabines classiques du Fort Wilderness, avec la flexibilité des points DVC." },
            { name: "Les terrains de camping au Disney's Fort Wilderness Resort", description: "Des emplacements de camping spacieux pour tentes et véhicules récréatifs, offrant une expérience en pleine nature avec toutes les commodités d'un complexe Disney, y compris piscines, activités et transport." },
            { name: "Les villas au Disney's Grand Floridian Resort & Spa", description: "Des villas luxueuses offrant l'élégance victorienne du Grand Floridian avec plus d'espace, des cuisines et des vues magnifiques, pour une expérience DVC haut de gamme." }
        ];

        const REGULAR_FONT_STACK = "Aptos, Arial, Helvetica, sans-serif";
        const BASE_FONT_SIZE = "11pt";
        const BASE_LINE_HEIGHT = "1.5";
        const TEXT_COLOR_BODY = "#000000";
        const EMAIL_MAIN_CONTAINER_STYLE = `font-family: ${REGULAR_FONT_STACK}; font-size: ${BASE_FONT_SIZE}; line-height: ${BASE_LINE_HEIGHT}; color: ${TEXT_COLOR_BODY}; background-color: transparent; padding: 5px;`;
        const PARAGRAPH_STYLE = `font-family: ${REGULAR_FONT_STACK}; font-size: ${BASE_FONT_SIZE}; line-height: ${BASE_LINE_HEIGHT}; margin-top: 12px; margin-bottom: 12px; color: ${TEXT_COLOR_BODY}; background-color: transparent;`;
        const LIST_STYLE = `font-family: ${REGULAR_FONT_STACK}; font-size: ${BASE_FONT_SIZE}; line-height: ${BASE_LINE_HEIGHT}; padding-left: 25px; margin-top: 12px; margin-bottom: 12px; color: ${TEXT_COLOR_BODY}; background-color: transparent;`;
        const LIST_ITEM_STYLE = `margin-bottom: 6px; background-color: transparent;`;
        const PROFESSIONAL_HORIZONTAL_RULE = `<div style="border-top: 1px solid #B0BEC5; margin: 30px 0; background-color: transparent;"></div>`;
        const BOLD_STYLE = "font-weight: bold;";
        const ITALIC_STYLE = "font-style: italic;";

        // --- STYLE DE BANNIÈRE CHOISI (Option A) ---
        const chosenBannerStyle = {
            tableBorderTop: "4px solid #FF7F50",    // Orange accent
            tableBorderBottom: "4px solid #FF7F50", // Orange accent
            cellBackgroundColor: "#0078C1",         // Primary Blue
            textColor: "#FFFFFF",                   // White text
            fontSizeMain: "1.4em",
            fontSizeSub: "1.2em",
            paddingMain: "12px 10px",
            paddingSub: "10px 10px",
            textAlign: "center",
            letterSpacing: "0.5px"
        };

        function createStyledBanner(text, styleOptions, isMainTitle = true) {
            const fontSize = isMainTitle ? styleOptions.fontSizeMain : styleOptions.fontSizeSub;
            const padding = isMainTitle ? styleOptions.paddingMain : styleOptions.paddingSub;
            let tableHtmlStyle = `width: 100%; margin-top: 25px; margin-bottom: 25px;`;
            if (styleOptions.tableBackgroundColor) tableHtmlStyle += ` background-color: ${styleOptions.tableBackgroundColor};`;
            if (styleOptions.tableBorderTop) tableHtmlStyle += ` border-top: ${styleOptions.tableBorderTop};`;
            if (styleOptions.tableBorderBottom) tableHtmlStyle += ` border-bottom: ${styleOptions.tableBorderBottom};`;

            let cellHtmlStyle = `padding: ${padding}; font-family: ${REGULAR_FONT_STACK}; font-size: ${fontSize}; color: ${styleOptions.textColor}; text-transform: uppercase; font-weight: bold; line-height: 1.3; letter-spacing: ${styleOptions.letterSpacing || '0.5px'};`;
            if (styleOptions.cellBackgroundColor) cellHtmlStyle += ` background-color: ${styleOptions.cellBackgroundColor};`;
            if (styleOptions.cellBorderBottom) cellHtmlStyle += ` border-bottom: ${styleOptions.cellBorderBottom};`;
            if (styleOptions.cellBorderTop) cellHtmlStyle += ` border-top: ${styleOptions.cellBorderTop};`;

            return `
            <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="${tableHtmlStyle.trim()}">
              <tr>
                <td align="${styleOptions.textAlign || 'center'}" style="${cellHtmlStyle.trim()}">
                  ${text}
                </td>
              </tr>
            </table>`;
        }

        function getHotelByName(name) { return DISNEY_HOTELS.find(hotel => hotel.name === name); }
        function formatDateFR(dateStr) { if (!dateStr) return ""; try { const date = new Date(dateStr + 'T00:00:00'); const options = { year: 'numeric', month: 'long', day: 'numeric' }; return date.toLocaleDateString('fr-FR', options); } catch (e) { return dateStr; } }
        function formatTime(timeStr) { if (!timeStr) return ""; try { const [hours, minutes] = timeStr.split(':'); let h = parseInt(hours, 10); return `${String(h).padStart(2, '0')} h ${String(minutes).padStart(2, '0')}`; } catch (e) { return timeStr; } }

        function generateEmailHTML(data) {
            let emailParts = [`<div style="${EMAIL_MAIN_CONTAINER_STYLE}">`];
            const T = { /* ... Votre objet TEXTS_FR ... */ 
                banner1: "VOTRE SÉJOUR AU WALT DISNEY WORLD RESORT EN FLORIDE",
                greeting: `Bonjour <strong style="${BOLD_STYLE}">${data.client_name || 'estimé(e) voyageur(se)'}</strong>,`,
                intro1: `Je vous écris au nom de Voyages en Route, où nous avons le plaisir d’accompagner les familles et voyageurs dans la planification de leurs séjours. Je m'appelle <strong style="${BOLD_STYLE}">Pierre-Luc Morin</strong> et je serais votre conseiller en voyages spécialisé en destinations <strong style="${BOLD_STYLE}">Disney et Universal</strong>.`,
                intro2: `Merci de nous avoir confié votre projet de voyage. J’ai pris soin de préparer une proposition basée sur les critères que vous avez partagés dans votre demande. Cette soumission est <strong style="${BOLD_STYLE}">ajustable</strong>, et je serai heureux d’explorer avec vous différentes options afin de vous créer une expérience <strong style="${BOLD_STYLE}">propre à vous et inoubliable</strong>.`,
                banner_disney_stay: "SÉJOUR DISNEY",
                disney_advantages_intro: `Séjourner dans un hôtel Disney, c’est profiter d’un univers immersif du matin au soir, mais aussi de <strong style="${BOLD_STYLE}">nombreux avantages exclusifs</strong>, tels que :`,
                disney_advantages_list_items: [
                    `<strong style="${BOLD_STYLE}">l’Early Theme Park Entry</strong>, pour accéder aux parcs avant l’ouverture officielle ;`,
                    `le <strong style="${BOLD_STYLE}">transport gratuit</strong> vers tous les parcs et sites Disney (excluant les transferts aéroports) ;`,
                    `l’<strong style="${BOLD_STYLE}">accès simplifié</strong> aux réservations avec l’application Disney Experience ;`,
                    `et un <strong style="${BOLD_STYLE}">service client exceptionnel</strong>, signé Disney, à chaque étape de votre séjour.`
                ],
                disney_price_disclaimer: "Veuillez noter que tous les prix pour l'hébergement et les billets Disney sont indiqués en dollars américains (USD) et sont sujets à disponibilité.",
                tickets_only_price_disclaimer: "Veuillez noter que tous les prix des billets Disney sont indiqués en dollars américains (USD) et sont sujets à disponibilité.",
                banner_travel_fees: "FRAIS DE DÉPLACEMENT",
                flight_intro: "Pour compléter votre voyage vers la magie, voici les détails concernant le transport aérien que nous avons exploré :",
                flight_price_info: `<em style="${ITALIC_STYLE}">Les prix sont à titre indicatif et peuvent changer à tout moment.</em>`,
                flight_important_label: `<strong style="${BOLD_STYLE}">IMPORTANT :</strong>`,
                flight_important_text: `Les tarifs aériens sont dynamiques et peuvent changer jusqu'à la réservation. Des frais de service de <strong style="${BOLD_STYLE}">50$ CAD par personne</strong> s'appliquent pour la réservation des vols via nos services. En me confiant vos vols, je m'occupe de tout désagrément potentiel. Si vous optez pour une réservation personnelle, ces frais ne s'appliquent pas, mais le support en cas de problème avec les vols ne sera pas inclus pour cette portion.`,
                banner_magic_continues: "LA MAGIE CONTINUE",
                closing1: `Prenez le temps de rêver à ces options et de considérer ce qui ferait de ce voyage une expérience <strong style="${BOLD_STYLE}">véritablement inoubliable</strong>. Je suis à votre <strong style="${BOLD_STYLE}">entière disposition</strong> pour répondre à toutes vos questions, affiner chaque détail ou procéder à la réservation de cette <em style="${ITALIC_STYLE}">escapade féérique</em>.`,
                closing2: `N'hésitez pas à me joindre par courriel (en répondant simplement à celui-ci) ou par téléphone au <strong style="${BOLD_STYLE}">819-347-9103</strong>.`,
                closing3: `Merci encore pour votre confiance. J'ai sincèrement hâte de transformer ce <strong style="${BOLD_STYLE}">rêve Disney</strong> en une <strong style="${BOLD_STYLE}">magnifique réalité pour vous !</strong>`
            };

            emailParts.push(createStyledBanner(T.banner1, chosenBannerStyle, true));
            emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.greeting}</p>`);
            emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.intro1}</p>`);
            emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.intro2}</p>`);
            emailParts.push(PROFESSIONAL_HORIZONTAL_RULE);

            emailParts.push(createStyledBanner(T.banner_disney_stay, chosenBannerStyle, false));
            const selectedHotels = Array.isArray(data.hotel_names) ? data.hotel_names.filter(h => h) : [];

            if (data.booking_type === 'hotel_tickets' && selectedHotels.length > 0) {
                // ... (logique d'affichage des hôtels, identique à v5/v6)
                 if (selectedHotels.length === 1) {
                    const hotel = getHotelByName(selectedHotels[0]);
                    emailParts.push(`<p style="${PARAGRAPH_STYLE}">Pour votre séjour au Walt Disney World Resort en Floride, j’ai préparé une option qui répond pleinement à vos besoins. J’ai sélectionné comme l’hébergement <strong style="${BOLD_STYLE}">${hotel.name}</strong>.</p>`);
                    emailParts.push(`<p style="${PARAGRAPH_STYLE}">Cette proposition inclut l’hébergement ainsi que les billets pour les parcs Disney.</p>`);
                    emailParts.push(`<p style="${PARAGRAPH_STYLE}">Tous les détails (dates, prix, inclusions et conditions) se trouvent dans le document PDF ci-joint.</p>`);
                    if (hotel) {
                        emailParts.push(`<div style="${PARAGRAPH_STYLE} margin-top:15px;"><strong style="${BOLD_STYLE} text-transform: uppercase;">${hotel.name}</strong><br>${hotel.description}</div>`);
                    }
                } else { 
                    emailParts.push(`<p style="${PARAGRAPH_STYLE}">Pour votre séjour au Walt Disney World Resort en Floride, plusieurs options d’hébergement sont possibles selon vos besoins. Les options possibles sont :</p>`);
                    let hotelListHtml = `<ul style="${LIST_STYLE}">`;
                    selectedHotels.forEach(hotelName => { hotelListHtml += `<li style="${LIST_ITEM_STYLE}">${hotelName}</li>`; });
                    hotelListHtml += "</ul>";
                    emailParts.push(hotelListHtml);
                    emailParts.push(`<p style="${PARAGRAPH_STYLE}">Les propositions incluent l’hébergement ainsi que les billets pour les parcs Disney.</p>`);
                    emailParts.push(`<p style="${PARAGRAPH_STYLE}">Tous les détails (dates, prix, inclusions et conditions) se trouvent dans les documents PDF ci-joints.</p>`);
                    selectedHotels.forEach((hotelName, index) => {
                        const hotel = getHotelByName(hotelName);
                        if (hotel) {
                             emailParts.push(`<div style="${PARAGRAPH_STYLE} margin-top:15px;"><strong style="${BOLD_STYLE}">OPTION ${index + 1} – ${hotel.name.toUpperCase()}</strong><br>${hotel.description}</div>`);
                        }
                    });
                }
                emailParts.push(`<p style="${PARAGRAPH_STYLE} margin-top:15px;">${T.disney_advantages_intro}</p>`);
                let advantagesListHtml = `<ul style="${LIST_STYLE}">`;
                T.disney_advantages_list_items.forEach(item => { advantagesListHtml += `<li style="${LIST_ITEM_STYLE}">${item}</li>`; });
                advantagesListHtml += `</ul>`;
                emailParts.push(advantagesListHtml);
            } else if (data.booking_type === 'tickets_only') {
                emailParts.push(`<p style="${PARAGRAPH_STYLE}">Pour votre séjour au Walt Disney World Resort en Floride, j’ai préparé pour vous un document ci-joint indiquant le prix ainsi que les conditions applicables aux billets de parc.</p>`);
            }

            let promoText = ""; // ... (logique promotions, identique)
            if (data.promotion_type === 'aucune') {
                promoText = `Pour garantir votre place au cœur de la magie, un dépôt de seulement <strong style="${BOLD_STYLE}">200 USD</strong> est requis. Soyez assuré que je veillerai personnellement à appliquer toute nouvelle promotion applicable d'ici votre départ pour optimiser la valeur de votre voyage. Ce dépôt est <strong style="${BOLD_STYLE}">entièrement remboursable jusqu'à 30 jours avant votre arrivée</strong>, vous offrant une <strong style="${BOLD_STYLE}">flexibilité totale</strong> pour planifier en toute sérénité.`;
            } else { 
                let promoEndDateInfo = data.promotion_end_date ? ` (prend fin le <strong style="${BOLD_STYLE}">${formatDateFR(data.promotion_end_date)}</strong>)` : "";
                let promoNameInfo = data.promotion_name ? ` : <strong style="${BOLD_STYLE}">${data.promotion_name}</strong>` : "";
                promoText = `Une promotion est applicable pour votre séjour${promoNameInfo}${promoEndDateInfo}. L’offre est cependant <em style="${ITALIC_STYLE}">limitée</em>. Pour garantir votre place au cœur de la magie, un dépôt de seulement <strong style="${BOLD_STYLE}">200 USD</strong> est requis. Soyez assuré que je veillerai personnellement à appliquer toute nouvelle promotion applicable d'ici votre départ pour optimiser la valeur de votre voyage. Ce dépôt est <strong style="${BOLD_STYLE}">entièrement remboursable jusqu'à 30 jours avant votre arrivée</strong>, vous offrant une <strong style="${BOLD_STYLE}">flexibilité totale</strong> pour planifier en toute sérénité.`;
            }
            emailParts.push(`<p style="${PARAGRAPH_STYLE} margin-top:15px;"><strong style="${BOLD_STYLE}">PROMOTIONS :</strong><br>${promoText}</p>`);
            
            if (data.booking_type === 'hotel_tickets' && selectedHotels.length > 0) {
                 emailParts.push(`<p style="${PARAGRAPH_STYLE} ${ITALIC_STYLE}">${T.disney_price_disclaimer}</p>`);
            } else if (data.booking_type === 'tickets_only') {
                emailParts.push(`<p style="${PARAGRAPH_STYLE} ${ITALIC_STYLE}">${T.tickets_only_price_disclaimer}</p>`);
            }
            emailParts.push(PROFESSIONAL_HORIZONTAL_RULE);

            if (data.include_flights) { // ... (logique vols, identique)
                emailParts.push(createStyledBanner(T.banner_travel_fees, chosenBannerStyle, false));
                emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.flight_intro}</p>`);
                let flightDetailsHtml = `<div style="margin-left: 20px; background-color: transparent;">`;
                flightDetailsHtml += `<p style="${PARAGRAPH_STYLE}"><strong style="${BOLD_STYLE}">Aller :</strong> ${formatDateFR(data.departure_date_aller)} à ${formatTime(data.departure_time_aller)}<br>De : ${data.departure_airport_aller || 'N/A'}<br>Vers : ${data.arrival_airport_aller || 'N/A'}</p>`;
                flightDetailsHtml += `<p style="${PARAGRAPH_STYLE}"><strong style="${BOLD_STYLE}">Retour :</strong> ${formatDateFR(data.departure_date_retour)} à ${formatTime(data.departure_time_retour)}<br>De : ${data.departure_airport_retour || 'N/A'}<br>Vers : ${data.arrival_airport_retour || 'N/A'}</p>`;
                const numAdults = parseInt(data.adults) || 0;
                const numChildren = parseInt(data.children) || 0;
                const totalPassengers = numAdults + numChildren;
                const adultText = numAdults > 1 ? "adultes" : "adulte";
                const childText = numChildren === 0 ? "" : (numChildren > 1 ? `${numChildren} enfants` : `${numChildren} enfant`);
                let passengerSummary = `${numAdults} ${adultText}`;
                if (numChildren > 0) { passengerSummary += `, ${childText}`; }
                flightDetailsHtml += `<p style="${PARAGRAPH_STYLE}"><strong style="${BOLD_STYLE}">Nombre de passagers :</strong> ${totalPassengers} (${passengerSummary})</p>`;
                flightDetailsHtml += `<p style="${PARAGRAPH_STYLE}"><strong style="${BOLD_STYLE}">Prix total approximatif des vols :</strong> ${data.flight_price || 'N/A'} CAD</p>`;
                flightDetailsHtml += "</div>";
                emailParts.push(flightDetailsHtml);
                emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.flight_price_info}</p>`);
                emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.flight_important_label} ${T.flight_important_text}</p>`);
                emailParts.push(PROFESSIONAL_HORIZONTAL_RULE);
            }

            emailParts.push(createStyledBanner(T.banner_magic_continues, chosenBannerStyle, false));
            emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.closing1}</p>`);
            emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.closing2}</p>`);
            emailParts.push(`<p style="${PARAGRAPH_STYLE}">${T.closing3}</p>`);
            emailParts.push("</div>");
            return emailParts.join("\n");
        }

        // --- GESTION DU FORMULAIRE ET INTERACTIONS (identique à v5) ---
        document.addEventListener('DOMContentLoaded', function() {
            const hotelSelectionsDiv = document.getElementById('hotel_selections');
            const addHotelButton = document.getElementById('add_hotel_button');
            function createHotelSelector(isFirst = false) {
                const hotelSelectionDiv = document.createElement('div');
                hotelSelectionDiv.classList.add('hotel-selection');
                const newSelect = document.createElement('select');
                newSelect.name = 'hotel_name[]';
                newSelect.classList.add('hotel-name-select');
                const placeholderOption = document.createElement('option');
                placeholderOption.value = "";
                placeholderOption.textContent = `Sélectionnez un hôtel`;
                newSelect.appendChild(placeholderOption);
                DISNEY_HOTELS.forEach(hotel => {
                    const option = document.createElement('option');
                    option.value = hotel.name;
                    option.textContent = hotel.name;
                    newSelect.appendChild(option);
                });
                hotelSelectionDiv.appendChild(newSelect);
                const removeButton = document.createElement('button');
                removeButton.type = 'button';
                removeButton.classList.add('remove-hotel-button');
                removeButton.textContent = '✕';
                removeButton.title = 'Supprimer cet hôtel';
                removeButton.addEventListener('click', function() {
                    hotelSelectionDiv.remove();
                    updateAddHotelButtonState();
                });
                hotelSelectionDiv.appendChild(removeButton);
                return hotelSelectionDiv;
            }
            function updateAddHotelButtonState() {
                const currentHotelSelectors = hotelSelectionsDiv.querySelectorAll('.hotel-selection').length;
                addHotelButton.disabled = currentHotelSelectors >= 5;
                addHotelButton.textContent = currentHotelSelectors >= 5 ? "Maximum 5 hôtels atteints" : "Ajouter une option d'hôtel";
            }
            addHotelButton.addEventListener('click', function() {
                const currentHotelSelectors = hotelSelectionsDiv.querySelectorAll('.hotel-selection').length;
                if (currentHotelSelectors < 5) { hotelSelectionsDiv.appendChild(createHotelSelector()); updateAddHotelButtonState(); }
            });
            hotelSelectionsDiv.appendChild(createHotelSelector(true)); updateAddHotelButtonState();
            const includeFlightsCheckbox = document.getElementById('include_flights');
            const flightDetailsDiv = document.getElementById('flight_details');
            const bookingTypeSelect = document.getElementById('booking_type');
            const hotelOptionsContainer = document.getElementById('hotel_options_container');
            const promotionTypeSelect = document.getElementById('promotion_type');
            const promotionDetailsDiv = document.getElementById('promotion_details');
            const form = document.getElementById('disneyForm');
            const emailOutputDiv = document.getElementById('emailOutput');
            const copyHtmlButton = document.getElementById('copyHtmlButton');
            function toggleFlightDetails() { flightDetailsDiv.classList.toggle('hidden', !includeFlightsCheckbox.checked); }
            function toggleHotelOptions() { 
                const isHotelBooking = bookingTypeSelect.value === 'hotel_tickets';
                hotelOptionsContainer.classList.toggle('hidden', !isHotelBooking);
                if (isHotelBooking && hotelSelectionsDiv.children.length === 0) { hotelSelectionsDiv.appendChild(createHotelSelector(true));}
                updateAddHotelButtonState();
            }
            function togglePromotionDetails() { promotionDetailsDiv.classList.toggle('hidden', promotionTypeSelect.value !== 'specifique'); }
            includeFlightsCheckbox.addEventListener('change', toggleFlightDetails);
            bookingTypeSelect.addEventListener('change', toggleHotelOptions);
            promotionTypeSelect.addEventListener('change', togglePromotionDetails);
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                const formData = new FormData(form); const data = {};
                const hotelNameElements = form.querySelectorAll('select[name="hotel_name[]"]');
                data.hotel_names = Array.from(hotelNameElements).map(select => select.value).filter(value => value !== "");
                for (let [key, value] of formData.entries()) {
                    if (key !== 'hotel_name[]') { if (key === 'include_flights') { data[key] = true; } else { data[key] = value; } }
                }
                if (!formData.has('include_flights')) { data.include_flights = false; }
                const emailHtmlContent = generateEmailHTML(data);
                emailOutputDiv.innerHTML = emailHtmlContent;
            });
            copyHtmlButton.addEventListener('click', function() {
                const range = document.createRange(); range.selectNodeContents(emailOutputDiv);
                const selection = window.getSelection(); selection.removeAllRanges(); selection.addRange(range);
                try { document.execCommand('copy'); alert('Contenu copié !'); } catch (err) { alert('Erreur copie.'); }
                selection.removeAllRanges();
            });
            toggleFlightDetails(); toggleHotelOptions(); togglePromotionDetails();
        });
    </script>
</body>
</html>
